'use strict';

angular.module('terminatorApp').controller('ProjectsCtrl', function ($state, $scope, $uibModal, ProjectsSvc, $filter, CompanySvc) {

  ////////////////////////////////////////

  $scope.getProjects = function () {
    ProjectsSvc.getProjects().then(function (res) {
      console.log(res);
      $scope.projects = res.data;
    });
  }();

  $scope.getTemplates = function () {
    ProjectsSvc.getTemplates().then(function (res) {
      $scope.templates = res.data;
    });
  }();

  $scope.getCompany = function () {
    CompanySvc.getCompanies().then(function (res) {
      $scope.companies = res.data;
      $scope.company = $scope.companies[0];
    });
  }();

  ////////////////////////////////////////

  $scope.sortProjectList = true;
  $scope.sortProjectList2 = true;
  $scope.sortProjectList3 = true;

  ////////////////////////////////////////

  $scope.cssClass = 'page-projects';
  $scope.yes = !$scope.yes;

  $scope.openSingleModal = function () {
    var modalInstance = $uibModal.open({
      animation: true,
      templateUrl: "./templates/projectsModal.html",
      controller: 'ProjectsCtrl',
      size: 'lg'
    });
  };

  $scope.openActivationModal = function (template) {
    var modalInstance = $uibModal.open({
      animation: true,
      templateUrl: "./templates/activateTemplate.html",
      controller: function controller($scope, ProjectsSvc) {
        $scope.template = template;
        $scope.dueDate = new Date();
        $scope.format = 'MM/dd/yy';

        $scope.activateTemplates = function (description) {
          var id = template._id;
          ProjectsSvc.activateTemplates(id, description).then(function (res) {
            console.log('response: ', res);
          }).then(function (res) {
            $scope.alerts.push({ msg: "Project Activated", type: "success" });
          }).catch(function (res) {
            $scope.alerts.push({ msg: "Failed to Activate Project", type: "danger" });
          });
        };
      },
      size: 'lg'
    });
  };

  // $scope.openScheduleModal = function() {
  //   var modalInstance = $uibModal.open({
  //     animation: true,
  //     templateUrl: "./templates/scheduledProject.html",
  //     controller: 'ProjectsCtrl',
  //     size: 'lg'
  //   })
  // };
  //
  // $scope.openTemplateModal = function() {
  //   var modalInstance = $uibModal.open({
  //     animation: true,
  //     templateUrl: "./templates/projectTemplates.html",
  //     controller: "ProjectsCtrl",
  //     size: "lg"
  //   })
  // }

  $scope.change = function () {
    $scope.meh = !$scope.meh;
  };

  $scope.openModal = function (project) {
    var modalInstance = $uibModal.open({
      animation: true,
      templateUrl: "./templates/singleProject.html",
      controller: function controller($scope) {
        $scope.project = project;
        console.log($scope.project);
      },
      size: 'lg'
    });
  };

  $scope.cancel = function () {
    $uibModalInstance.dismiss('cancel');
  };

  $scope.addTask = function () {
    $scope.showTaskBox = !$scope.showTaskBox;
  };

  $scope.cancelAddTask = function () {
    $scope.showTaskBox = !$scope.showTaskBox;
  };

  $scope.newSingleProject = {
    setup: { type: "Single" }
  };
  $scope.postProject = function (newSingleProject) {
    console.log("New Single Project Info: ", newSingleProject);
    ProjectsSvc.postProject(newSingleProject).then(function (results) {
      console.log("Single Project added: ", results);
    }).then(function (res) {
      $scope.alerts.push({ msg: "Project ID Created", type: "success" });
    }).catch(function (res) {
      $scope.alerts.push({ msg: "Failed to Create Project", type: "danger" });
    });
  };

  $scope.newTemplate = {};

  $scope.showTheRest = false;
  $scope.alerts = [];

  $scope.templateID = "";

  $scope.closeAlert = function (index) {
    $scope.alerts.splice(index, 1);
  };

  // $scope.saveProject = function() {
  //   var modalInstance = $uibModal.open({
  //     animation: true,
  //     templateUrl: "./templates/projectTasks.html",
  //     controller: "ProjectsCtrl",
  //     size: "lg"
  //   })
  // }
  //////////////////////////////////////////////////////////

  $scope.today = function () {
    $scope.dt = new Date();
  };
  $scope.today();

  $scope.clear = function () {
    $scope.dt = null;
  };

  // Disable weekend selection
  $scope.disabled = function (date, mode) {
    return mode === 'day' && (date.getDay() === 0 || date.getDay() === 6);
  };

  $scope.toggleMin = function () {
    $scope.minDate = $scope.minDate ? null : new Date();
  };

  $scope.toggleMin();
  $scope.maxDate = new Date(2020, 5, 22);

  $scope.open1 = function (event) {
    console.log(event);
    $scope.popup1.opened = true;
  };

  $scope.open2 = function () {
    $scope.popup2.opened = true;
  };

  $scope.open3 = function () {
    $scope.popup3.opened = true;
  };

  $scope.setDate = function (year, month, day) {
    $scope.dt = new Date(year, month, day);
  };

  $scope.dateOptions = {
    formatYear: 'yy',
    startingDay: 1
  };

  $scope.formats = ['dd-MMMM-yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];
  $scope.format = $scope.formats[0];
  $scope.altInputFormats = ['M!/d!/yyyy'];

  $scope.popup1 = {
    opened: false
  };

  $scope.popup2 = {
    opened: false
  };

  $scope.popup3 = {
    opened: false
  };

  var tomorrow = new Date();
  tomorrow.setDate(tomorrow.getDate() + 1);
  var afterTomorrow = new Date();
  afterTomorrow.setDate(tomorrow.getDate() + 1);
  $scope.events = [{
    date: tomorrow,
    status: 'full'
  }, {
    date: afterTomorrow,
    status: 'partially'
  }];

  $scope.getDayClass = function (date, mode) {
    if (mode === 'day') {
      var dayToCheck = new Date(date).setHours(0, 0, 0, 0);

      for (var i = 0; i < $scope.events.length; i++) {
        var currentDay = new Date($scope.events[i].date).setHours(0, 0, 0, 0);

        if (dayToCheck === currentDay) {
          return $scope.events[i].status;
        }
      }
    }

    return '';
  };

  ////////
  //Updates to the project control from Template control
  ////////

  $scope.newTask = {
    name: '',
    description: '',
    assignment: {
      departments: '',
      positions: '',
      employees: ''
    }
  };

  $scope.newTasksArr = [];
  $scope.newTasksDisplayArray = [];

  $scope.saveTask = function (newTask) {
    newTask.associatedTemplate = $scope.templateID;
    console.log(newTask);
    $scope.newTasksDisplayArray.push(newTask);
    if (newTask.assignment.departments) newTask.assignment.departments = newTask.assignment.departments._id;
    if (newTask.assignment.positions) newTask.assignment.positions = newTask.assignment.positions._id;
    if (newTask.assignment.employees) newTask.assignment.employee = newTask.assignment.employee._id;
    $scope.newTasksArr.push(newTask);
    console.log("newTasksArr", $scope.newTasksArr);
    $scope.newTask = {
      name: '',
      description: '',
      assignment: {
        departments: '',
        positions: '',
        employees: ''
      }
    };
    // $scope.selectedAssign = null; tryig to clear drop downs with this.
  };

  $scope.addTasks = function (newTasksArr) {
    ProjectsSvc.postTasks(newTasksArr, $scope.templateID).then(function (results) {
      console.log("Tasks added successfully", results);
      // $state.go('projects');
    });
  };

  $scope.allowedIntervalTypes = ['Daily', 'Daily Business Days', 'Weekly', 'Bi-Weekly', 'Monthly', 'Semi-Monthly', 'Quarterly', 'Annually'];
  $scope.allowedFrequencies = ["Triggered", "Scheduled"];
  $scope.allowedDays = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
  $scope.allowedWeeklyIntervals = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday', 'Any'];
  $scope.allowedMonthlyIntervals = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
  $scope.allowedSemiMonthlyIntervals = ["1st", "2nd", "3rd", "4th", "5th", "6th", "7th", "8th", "9th", "10th", "11th", "12th", "13th", "14th", "15th"];
  $scope.allowedQuarterlyIntervals = ["First Day of the Quarter", "Last Day of the Quarter", "# Days from Start", "# Days from End", "Any"];
  $scope.allowedAnnuallyIntervals = ["First Day of the Year", "Last Day of the Year", "Any Day of the year", "In a Particular Month", "In a Particular Quarter", "# of Days From Start", "# of Days Before End"];

  /////////////////
  //Adding Scheduled Project
  /////////////////

  $scope.newInterval = {};

  $scope.addIntervalProject = function (newInterval) {
    ProjectsSvc.postIntervalProject(newInterval).then(function (results) {
      console.log("New Scheduled Project added", results);
      $scope.templateID = results.data._id;
      console.log($scope.templateID);
      // $state.go('templateTasks', {"id": templateID});
    }).then(function (res) {
      $scope.alerts.push({ msg: "Project ID Created", type: "success" });
    }).catch(function (res) {
      $scope.alerts.push({ msg: "Failed to Create Project", type: "danger" });
    });
    $scope.showTheRest = true;
  };

  $scope.singleProject = {};

  $scope.addSingleProject = function (singleProject) {
    ProjectsSvc.postSingleProject(singleProject).then(function (results) {
      console.log("New Single Project added", results);
      $scope.templateID = results.data._id;
      console.log($scope.templateID);
      // $state.go('templateTasks', {"id": templateID});
    }).then(function (res) {
      $scope.alerts.push({ msg: "Project ID Created", type: "success" });
    }).catch(function (res) {
      $scope.alerts.push({ msg: "Failed to Create Project", type: "danger" });
    });
    $scope.showTheRest = true;
  };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInB1YmxpYy9jb250cm9sbGVycy9Qcm9qZWN0c0N0cmwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLENBQUMsTUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxjQUFjLEVBQUUsVUFBUyxNQUFNLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxXQUFXLEVBQUUsT0FBTyxFQUFFLFVBQVUsRUFBRTs7OztBQUkvSCxRQUFNLENBQUMsV0FBVyxHQUFHLFlBQVc7QUFDOUIsZUFBVyxDQUFDLFdBQVcsRUFBRSxDQUFDLElBQUksQ0FBQyxVQUFTLEdBQUcsRUFBRTtBQUMzQyxhQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ2pCLFlBQU0sQ0FBQyxRQUFRLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQztLQUM1QixDQUFDLENBQUM7R0FDSixFQUFFLENBQUM7O0FBRUosUUFBTSxDQUFDLFlBQVksR0FBRyxZQUFXO0FBQy9CLGVBQVcsQ0FBQyxZQUFZLEVBQUUsQ0FBQyxJQUFJLENBQUMsVUFBUyxHQUFHLEVBQUU7QUFDNUMsWUFBTSxDQUFDLFNBQVMsR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDO0tBRTdCLENBQUMsQ0FBQztHQUNKLEVBQUUsQ0FBQzs7QUFFSixRQUFNLENBQUMsVUFBVSxHQUFHLFlBQVc7QUFDN0IsY0FBVSxDQUFDLFlBQVksRUFBRSxDQUFDLElBQUksQ0FBQyxVQUFTLEdBQUcsRUFBRTtBQUMzQyxZQUFNLENBQUMsU0FBUyxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUE7QUFDM0IsWUFBTSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQ3RDLENBQUMsQ0FBQztHQUNKLEVBQUU7Ozs7QUFBQyxBQUlKLFFBQU0sQ0FBQyxlQUFlLEdBQUcsSUFBSSxDQUFDO0FBQzlCLFFBQU0sQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLENBQUM7QUFDL0IsUUFBTSxDQUFD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LENBQUMsR0FBRyxDQUFDLDBCQUEwQixFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ2pELFlBQU0sQ0FBQyxVQUFVLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7QUFDckMsYUFBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDOztBQUFDLEtBRWhDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBUyxHQUFHLEVBQUU7QUFDcEIsWUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBQyxHQUFHLEVBQUUsb0JBQW9CLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBQyxDQUFDLENBQUM7S0FDbEUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFTLEdBQUcsRUFBRTtBQUNyQixZQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFDLEdBQUcsRUFBRSwwQkFBMEIsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFDLENBQUMsQ0FBQztLQUN2RSxDQUFDLENBQUM7QUFDSCxVQUFNLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztHQUM3QixDQUFDO0NBRUgsQ0FBQyxDQUFDIiwiZmlsZSI6InB1YmxpYy9jb250cm9sbGVycy9Qcm9qZWN0c0N0cmwuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgndGVybWluYXRvckFwcCcpLmNvbnRyb2xsZXIoJ1Byb2plY3RzQ3RybCcsIGZ1bmN0aW9uKCRzdGF0ZSwgJHNjb3BlLCAkdWliTW9kYWwsIFByb2plY3RzU3ZjLCAkZmlsdGVyLCBDb21wYW55U3ZjKSB7XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAkc2NvcGUuZ2V0UHJvamVjdHMgPSBmdW5jdGlvbigpIHtcbiAgICBQcm9qZWN0c1N2Yy5nZXRQcm9qZWN0cygpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICBjb25zb2xlLmxvZyhyZXMpO1xuICAgICAgJHNjb3BlLnByb2plY3RzID0gcmVzLmRhdGE7XG4gICAgfSk7XG4gIH0oKTtcblxuICAkc2NvcGUuZ2V0VGVtcGxhdGVzID0gZnVuY3Rpb24oKSB7XG4gICAgUHJvamVjdHNTdmMuZ2V0VGVtcGxhdGVzKCkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICRzY29wZS50ZW1wbGF0ZXMgPSByZXMuZGF0YTtcblxuICAgIH0pO1xuICB9KCk7XG5cbiAgJHNjb3BlLmdldENvbXBhbnkgPSBmdW5jdGlvbigpIHtcbiAgICBDb21wYW55U3ZjLmdldENvbXBhbmllcygpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAkc2NvcGUuY29tcGFuaWVzID0gcmVzLmRhdGFcbiAgICAgICRzY29wZS5jb21wYW55ID0gJHNjb3BlLmNvbXBhbmllc1swXTtcbiAgICB9KTtcbiAgfSgpO1xuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgJHNjb3BlLnNvcnRQcm9qZWN0TGlzdCA9IHRydWU7XG4gICRzY29wZS5zb3J0UHJvamVjdExpc3QyID0gdHJ1ZTtcbiAgJHNjb3BlLnNvcnRQcm9qZWN0TGlzdDMgPSB0cnVlO1xuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgJHNjb3BlLmNzc0NsYXNzID0gJ3BhZ2UtcHJvamVjdHMnO1xuICAkc2NvcGUueWVzID0gISRzY29wZS55ZXM7XG5cbiAgJHNjb3BlLm9wZW5TaW5nbGVNb2RhbCA9IGZ1bmN0aW9uKCkge1xuICBcdHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICBcdFx0YW5pbWF0aW9uOiB0cnVlLFxuICBcdFx0dGVtcGxhdGVVcmw6IFwiLi90ZW1wbGF0ZXMvcHJvamVjdHNNb2RhbC5odG1sXCIsXG4gICAgICBjb250cm9sbGVyOiAnUHJvamVjdHNDdHJsJyxcbiAgICAgIHNpemU6ICdsZydcbiAgXHR9KTtcbiAgfTtcblxuICAkc2NvcGUub3BlbkFjdGl2YXRpb25Nb2RhbCA9IGZ1bmN0aW9uKHRlbXBsYXRlKSB7XG4gIFx0dmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG4gIFx0XHRhbmltYXRpb246IHRydWUsXG4gIFx0XHR0ZW1wbGF0ZVVybDogXCIuL3RlbXBsYXRlcy9hY3RpdmF0ZVRlbXBsYXRlLmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uICgkc2NvcGUsIFByb2plY3RzU3ZjKSB7XG4gICAgICAgICRzY29wZS50ZW1wbGF0ZSA9IHRlbXBsYXRlO1xuICAgICAgICAkc2NvcGUuZHVlRGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgICRzY29wZS5mb3JtYXQgPSAnTU0vZGQveXknO1xuXG4gICAgICAgICRzY29wZS5hY3RpdmF0ZVRlbXBsYXRlcyA9IGZ1bmN0aW9uIChkZXNjcmlwdGlvbil7XG4gICAgICAgICAgdmFyIGlkID0gdGVtcGxhdGUuX2lkXG4gICAgICAgICAgUHJvamVjdHNTdmMuYWN0aXZhdGVUZW1wbGF0ZXMoaWQsIGRlc2NyaXB0aW9uKS50aGVuIChmdW5jdGlvbihyZXMpe1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3Jlc3BvbnNlOiAnLCByZXMpO1xuICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAkc2NvcGUuYWxlcnRzLnB1c2goe21zZzogXCJQcm9qZWN0IEFjdGl2YXRlZFwiLCB0eXBlOiBcInN1Y2Nlc3NcIn0pXG4gICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAkc2NvcGUuYWxlcnRzLnB1c2goe21zZzogXCJGYWlsZWQgdG8gQWN0aXZhdGUgUHJvamVjdFwiLCB0eXBlOiBcImRhbmdlclwifSlcbiAgICAgICAgICB9KVxuICAgICAgICB9O1xuXG4gICAgICB9LFxuICAgICAgc2l6ZTogJ2xnJ1xuICBcdH0pO1xuICB9O1xuXG4gIC8vICRzY29wZS5vcGVuU2NoZWR1bGVNb2RhbCA9IGZ1bmN0aW9uKCkge1xuICAvLyAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAvLyAgICAgYW5pbWF0aW9uOiB0cnVlLFxuICAvLyAgICAgdGVtcGxhdGVVcmw6IFwiLi90ZW1wbGF0ZXMvc2NoZWR1bGVkUHJvamVjdC5odG1sXCIsXG4gIC8vICAgICBjb250cm9sbGVyOiAnUHJvamVjdHNDdHJsJyxcbiAgLy8gICAgIHNpemU6ICdsZydcbiAgLy8gICB9KVxuICAvLyB9O1xuICAvL1xuICAvLyAkc2NvcGUub3BlblRlbXBsYXRlTW9kYWwgPSBmdW5jdGlvbigpIHtcbiAgLy8gICB2YXIgbW9kYWxJbnN0YW5jZSA9ICR1aWJNb2RhbC5vcGVuKHtcbiAgLy8gICAgIGFuaW1hdGlvbjogdHJ1ZSxcbiAgLy8gICAgIHRlbXBsYXRlVXJsOiBcIi4vdGVtcGxhdGVzL3Byb2plY3RUZW1wbGF0ZXMuaHRtbFwiLFxuICAvLyAgICAgY29udHJvbGxlcjogXCJQcm9qZWN0c0N0cmxcIixcbiAgLy8gICAgIHNpemU6IFwibGdcIlxuICAvLyAgIH0pXG4gIC8vIH1cblxuICAkc2NvcGUuY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gIFx0JHNjb3BlLm1laCA9ICEkc2NvcGUubWVoO1xuICB9O1xuXG4gICRzY29wZS5vcGVuTW9kYWwgPSBmdW5jdGlvbihwcm9qZWN0KSB7XG4gIFx0dmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG4gIFx0XHRhbmltYXRpb246IHRydWUsXG4gIFx0XHR0ZW1wbGF0ZVVybDogXCIuL3RlbXBsYXRlcy9zaW5nbGVQcm9qZWN0Lmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uICgkc2NvcGUpIHtcbiAgICAgICAgJHNjb3BlLnByb2plY3QgPSBwcm9qZWN0O1xuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUucHJvamVjdCk7XG4gICAgICB9LFxuICAgICAgc2l6ZTogJ2xnJ1xuICBcdH0pO1xuICB9O1xuXG4gICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgJHVpYk1vZGFsSW5zdGFuY2UuZGlzbWlzcygnY2FuY2VsJyk7XG4gIH07XG5cbiAgJHNjb3BlLmFkZFRhc2sgPSBmdW5jdGlvbigpIHtcbiAgICAkc2NvcGUuc2hvd1Rhc2tCb3ggPSAhJHNjb3BlLnNob3dUYXNrQm94O1xuICB9O1xuXG4gICRzY29wZS5jYW5jZWxBZGRUYXNrID0gZnVuY3Rpb24oKSB7XG4gICAgJHNjb3BlLnNob3dUYXNrQm94ID0gISRzY29wZS5zaG93VGFza0JveDtcbiAgfTtcblxuICAkc2NvcGUubmV3U2luZ2xlUHJvamVjdCA9IHtcbiAgICBzZXR1cDoge3R5cGU6IFwiU2luZ2xlXCJ9XG4gIH07XG4gICRzY29wZS5wb3N0UHJvamVjdCA9IGZ1bmN0aW9uKG5ld1NpbmdsZVByb2plY3QpIHtcbiAgICBjb25zb2xlLmxvZyhcIk5ldyBTaW5nbGUgUHJvamVjdCBJbmZvOiBcIiwgbmV3U2luZ2xlUHJvamVjdCk7XG4gICAgUHJvamVjdHNTdmMucG9zdFByb2plY3QobmV3U2luZ2xlUHJvamVjdCkudGhlbihmdW5jdGlvbihyZXN1bHRzKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIlNpbmdsZSBQcm9qZWN0IGFkZGVkOiBcIiwgcmVzdWx0cyk7XG4gICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICRzY29wZS5hbGVydHMucHVzaCh7bXNnOiBcIlByb2plY3QgSUQgQ3JlYXRlZFwiLCB0eXBlOiBcInN1Y2Nlc3NcIn0pO1xuICAgIH0pLmNhdGNoKGZ1bmN0aW9uKHJlcykge1xuICAgICAgJHNjb3BlLmFsZXJ0cy5wdXNoKHttc2c6IFwiRmFpbGVkIHRvIENyZWF0ZSBQcm9qZWN0XCIsIHR5cGU6IFwiZGFuZ2VyXCJ9KTtcbiAgICB9KTtcbiAgfTtcblxuICAkc2NvcGUubmV3VGVtcGxhdGUgPSB7fTtcblxuICAkc2NvcGUuc2hvd1RoZVJlc3QgPSBmYWxzZTtcbiAgJHNjb3BlLmFsZXJ0cyA9IFtdO1xuXG4gICRzY29wZS50ZW1wbGF0ZUlEID0gXCJcIjtcblxuICAkc2NvcGUuY2xvc2VBbGVydCA9IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgJHNjb3BlLmFsZXJ0cy5zcGxpY2UoaW5kZXgsIDEpO1xuICB9O1xuXG5cbiAgLy8gJHNjb3BlLnNhdmVQcm9qZWN0ID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgdmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG4gIC8vICAgICBhbmltYXRpb246IHRydWUsXG4gIC8vICAgICB0ZW1wbGF0ZVVybDogXCIuL3RlbXBsYXRlcy9wcm9qZWN0VGFza3MuaHRtbFwiLFxuICAvLyAgICAgY29udHJvbGxlcjogXCJQcm9qZWN0c0N0cmxcIixcbiAgLy8gICAgIHNpemU6IFwibGdcIlxuICAvLyAgIH0pXG4gIC8vIH1cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuXG4gICRzY29wZS50b2RheSA9IGZ1bmN0aW9uKCkge1xuICAgICRzY29wZS5kdCA9IG5ldyBEYXRlKCk7XG4gIH07XG4gICRzY29wZS50b2RheSgpO1xuXG4gICRzY29wZS5jbGVhciA9IGZ1bmN0aW9uKCkge1xuICAgICRzY29wZS5kdCA9IG51bGw7XG4gIH07XG5cbiAgLy8gRGlzYWJsZSB3ZWVrZW5kIHNlbGVjdGlvblxuICAkc2NvcGUuZGlzYWJsZWQgPSBmdW5jdGlvbihkYXRlLCBtb2RlKSB7XG4gICAgcmV0dXJuIG1vZGUgPT09ICdkYXknICYmIChkYXRlLmdldERheSgpID09PSAwIHx8IGRhdGUuZ2V0RGF5KCkgPT09IDYpO1xuICB9O1xuXG4gICRzY29wZS50b2dnbGVNaW4gPSBmdW5jdGlvbigpIHtcbiAgICAkc2NvcGUubWluRGF0ZSA9ICRzY29wZS5taW5EYXRlID8gbnVsbCA6IG5ldyBEYXRlKCk7XG4gIH07XG5cbiAgJHNjb3BlLnRvZ2dsZU1pbigpO1xuICAkc2NvcGUubWF4RGF0ZSA9IG5ldyBEYXRlKDIwMjAsIDUsIDIyKTtcblxuICAkc2NvcGUub3BlbjEgPSBmdW5jdGlvbihldmVudCkge1xuICAgIGNvbnNvbGUubG9nKGV2ZW50KTtcbiAgICAkc2NvcGUucG9wdXAxLm9wZW5lZCA9IHRydWU7XG4gIH07XG5cbiAgJHNjb3BlLm9wZW4yID0gZnVuY3Rpb24oKSB7XG4gICAgJHNjb3BlLnBvcHVwMi5vcGVuZWQgPSB0cnVlO1xuICB9O1xuXG4gICRzY29wZS5vcGVuMyA9IGZ1bmN0aW9uKCkge1xuICAgICRzY29wZS5wb3B1cDMub3BlbmVkID0gdHJ1ZTtcbiAgfTtcblxuICAkc2NvcGUuc2V0RGF0ZSA9IGZ1bmN0aW9uKHllYXIsIG1vbnRoLCBkYXkpIHtcbiAgICAkc2NvcGUuZHQgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgZGF5KTtcbiAgfTtcblxuICAkc2NvcGUuZGF0ZU9wdGlvbnMgPSB7XG4gICAgZm9ybWF0WWVhcjogJ3l5JyxcbiAgICBzdGFydGluZ0RheTogMVxuICB9O1xuXG4gICRzY29wZS5mb3JtYXRzID0gWydkZC1NTU1NLXl5eXknLCAneXl5eS9NTS9kZCcsICdkZC5NTS55eXl5JywgJ3Nob3J0RGF0ZSddO1xuICAkc2NvcGUuZm9ybWF0ID0gJHNjb3BlLmZvcm1hdHNbMF07XG4gICRzY29wZS5hbHRJbnB1dEZvcm1hdHMgPSBbJ00hL2QhL3l5eXknXTtcblxuXG4gICRzY29wZS5wb3B1cDEgPSB7XG4gICAgb3BlbmVkOiBmYWxzZVxuICB9O1xuXG4gICRzY29wZS5wb3B1cDIgPSB7XG4gICAgb3BlbmVkOiBmYWxzZVxuICB9O1xuXG4gICRzY29wZS5wb3B1cDMgPSB7XG4gICAgb3BlbmVkOiBmYWxzZVxuICB9O1xuXG4gIHZhciB0b21vcnJvdyA9IG5ldyBEYXRlKCk7XG4gIHRvbW9ycm93LnNldERhdGUodG9tb3Jyb3cuZ2V0RGF0ZSgpICsgMSk7XG4gIHZhciBhZnRlclRvbW9ycm93ID0gbmV3IERhdGUoKTtcbiAgYWZ0ZXJUb21vcnJvdy5zZXREYXRlKHRvbW9ycm93LmdldERhdGUoKSArIDEpO1xuICAkc2NvcGUuZXZlbnRzID1cbiAgICBbXG4gICAgICB7XG4gICAgICAgIGRhdGU6IHRvbW9ycm93LFxuICAgICAgICBzdGF0dXM6ICdmdWxsJ1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgZGF0ZTogYWZ0ZXJUb21vcnJvdyxcbiAgICAgICAgc3RhdHVzOiAncGFydGlhbGx5J1xuICAgICAgfVxuICAgIF07XG5cbiAgJHNjb3BlLmdldERheUNsYXNzID0gZnVuY3Rpb24oZGF0ZSwgbW9kZSkge1xuICAgIGlmIChtb2RlID09PSAnZGF5Jykge1xuICAgICAgdmFyIGRheVRvQ2hlY2sgPSBuZXcgRGF0ZShkYXRlKS5zZXRIb3VycygwLDAsMCwwKTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAkc2NvcGUuZXZlbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBjdXJyZW50RGF5ID0gbmV3IERhdGUoJHNjb3BlLmV2ZW50c1tpXS5kYXRlKS5zZXRIb3VycygwLDAsMCwwKTtcblxuICAgICAgICBpZiAoZGF5VG9DaGVjayA9PT0gY3VycmVudERheSkge1xuICAgICAgICAgIHJldHVybiAkc2NvcGUuZXZlbnRzW2ldLnN0YXR1cztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAnJztcbiAgfTtcblxuICAvLy8vLy8vL1xuICAvL1VwZGF0ZXMgdG8gdGhlIHByb2plY3QgY29udHJvbCBmcm9tIFRlbXBsYXRlIGNvbnRyb2xcbiAgLy8vLy8vLy9cblxuICAkc2NvcGUubmV3VGFzayA9IHtcbiAgICBuYW1lOiAnJyxcbiAgICBkZXNjcmlwdGlvbjogJycsXG4gICAgYXNzaWdubWVudDoge1xuICAgICAgZGVwYXJ0bWVudHM6ICcnLFxuICAgICAgcG9zaXRpb25zOiAnJyxcbiAgICAgIGVtcGxveWVlczogJydcbiAgICB9XG4gIH07XG5cbiAgJHNjb3BlLm5ld1Rhc2tzQXJyID0gW107XG4gICRzY29wZS5uZXdUYXNrc0Rpc3BsYXlBcnJheSA9IFtdO1xuXG5cbiAgJHNjb3BlLnNhdmVUYXNrID0gZnVuY3Rpb24obmV3VGFzaykge1xuICAgIG5ld1Rhc2suYXNzb2NpYXRlZFRlbXBsYXRlID0gJHNjb3BlLnRlbXBsYXRlSUQ7XG4gICAgY29uc29sZS5sb2cobmV3VGFzayk7XG4gICAgJHNjb3BlLm5ld1Rhc2tzRGlzcGxheUFycmF5LnB1c2gobmV3VGFzayk7XG4gICAgaWYobmV3VGFzay5hc3NpZ25tZW50LmRlcGFydG1lbnRzKSBuZXdUYXNrLmFzc2lnbm1lbnQuZGVwYXJ0bWVudHMgPSBuZXdUYXNrLmFzc2lnbm1lbnQuZGVwYXJ0bWVudHMuX2lkO1xuICAgIGlmKG5ld1Rhc2suYXNzaWdubWVudC5wb3NpdGlvbnMpIG5ld1Rhc2suYXNzaWdubWVudC5wb3NpdGlvbnMgPSBuZXdUYXNrLmFzc2lnbm1lbnQucG9zaXRpb25zLl9pZDtcbiAgICBpZihuZXdUYXNrLmFzc2lnbm1lbnQuZW1wbG95ZWVzKSBuZXdUYXNrLmFzc2lnbm1lbnQuZW1wbG95ZWUgPSBuZXdUYXNrLmFzc2lnbm1lbnQuZW1wbG95ZWUuX2lkO1xuICAgICRzY29wZS5uZXdUYXNrc0Fyci5wdXNoKG5ld1Rhc2spO1xuICAgIGNvbnNvbGUubG9nKFwibmV3VGFza3NBcnJcIiwgJHNjb3BlLm5ld1Rhc2tzQXJyKTtcbiAgICAkc2NvcGUubmV3VGFzayA9IHtcbiAgICAgIG5hbWU6ICcnLFxuICAgICAgZGVzY3JpcHRpb246ICcnLFxuICAgICAgYXNzaWdubWVudDoge1xuICAgICAgICBkZXBhcnRtZW50czogJycsXG4gICAgICAgIHBvc2l0aW9uczogJycsXG4gICAgICAgIGVtcGxveWVlczogJydcbiAgICAgIH1cbiAgICB9O1xuICAgIC8vICRzY29wZS5zZWxlY3RlZEFzc2lnbiA9IG51bGw7IHRyeWlnIHRvIGNsZWFyIGRyb3AgZG93bnMgd2l0aCB0aGlzLlxuICB9O1xuXG4gICRzY29wZS5hZGRUYXNrcyA9IGZ1bmN0aW9uKG5ld1Rhc2tzQXJyKSB7XG4gICAgUHJvamVjdHNTdmMucG9zdFRhc2tzKG5ld1Rhc2tzQXJyLCAkc2NvcGUudGVtcGxhdGVJRCkudGhlbihmdW5jdGlvbihyZXN1bHRzKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIlRhc2tzIGFkZGVkIHN1Y2Nlc3NmdWxseVwiLCByZXN1bHRzKTtcbiAgICAgIC8vICRzdGF0ZS5nbygncHJvamVjdHMnKTtcbiAgICB9KTtcbiAgfTtcblxuICAkc2NvcGUuYWxsb3dlZEludGVydmFsVHlwZXMgPSBbJ0RhaWx5JywgJ0RhaWx5IEJ1c2luZXNzIERheXMnLCAnV2Vla2x5JywgJ0JpLVdlZWtseScsICdNb250aGx5JywgJ1NlbWktTW9udGhseScsICdRdWFydGVybHknLCAnQW5udWFsbHknXTtcbiAgJHNjb3BlLmFsbG93ZWRGcmVxdWVuY2llcyA9IFtcIlRyaWdnZXJlZFwiLCBcIlNjaGVkdWxlZFwiXTtcbiAgJHNjb3BlLmFsbG93ZWREYXlzID0gWydTdW5kYXknLCdNb25kYXknLCdUdWVzZGF5JywnV2VkbmVzZGF5JywnVGh1cnNkYXknLCdGcmlkYXknLCdTYXR1cmRheSddO1xuICAkc2NvcGUuYWxsb3dlZFdlZWtseUludGVydmFscyA9IFsnTW9uZGF5JywgJ1R1ZXNkYXknLCAnV2VkbmVzZGF5JywgJ1RodXJzZGF5JywgJ0ZyaWRheScsICdTYXR1cmRheScsICdTdW5kYXknLCAnQW55J107XG4gICRzY29wZS5hbGxvd2VkTW9udGhseUludGVydmFscyA9IFsnSmFudWFyeScsICdGZWJydWFyeScsICdNYXJjaCcsICdBcHJpbCcsICdNYXknLCAnSnVuZScsICdKdWx5JywgJ0F1Z3VzdCcsICdTZXB0ZW1iZXInLCAnT2N0b2JlcicsICdOb3ZlbWJlcicsICdEZWNlbWJlciddO1xuICAkc2NvcGUuYWxsb3dlZFNlbWlNb250aGx5SW50ZXJ2YWxzID0gW1wiMXN0XCIsXCIybmRcIiwgXCIzcmRcIiwgXCI0dGhcIiwgXCI1dGhcIixcIjZ0aFwiLFwiN3RoXCIsXCI4dGhcIixcIjl0aFwiLFwiMTB0aFwiLFwiMTF0aFwiLFwiMTJ0aFwiLFwiMTN0aFwiLFwiMTR0aFwiLFwiMTV0aFwiXTtcbiAgJHNjb3BlLmFsbG93ZWRRdWFydGVybHlJbnRlcnZhbHMgPSBbXCJGaXJzdCBEYXkgb2YgdGhlIFF1YXJ0ZXJcIiwgXCJMYXN0IERheSBvZiB0aGUgUXVhcnRlclwiLCBcIiMgRGF5cyBmcm9tIFN0YXJ0XCIsIFwiIyBEYXlzIGZyb20gRW5kXCIsIFwiQW55XCIgXTtcbiAgJHNjb3BlLmFsbG93ZWRBbm51YWxseUludGVydmFscyA9IFtcIkZpcnN0IERheSBvZiB0aGUgWWVhclwiLCBcIkxhc3QgRGF5IG9mIHRoZSBZZWFyXCIsIFwiQW55IERheSBvZiB0aGUgeWVhclwiLCBcIkluIGEgUGFydGljdWxhciBNb250aFwiLCBcIkluIGEgUGFydGljdWxhciBRdWFydGVyXCIsIFwiIyBvZiBEYXlzIEZyb20gU3RhcnRcIiwgXCIjIG9mIERheXMgQmVmb3JlIEVuZFwiXTtcblxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vXG4gIC8vQWRkaW5nIFNjaGVkdWxlZCBQcm9qZWN0XG4gIC8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgJHNjb3BlLm5ld0ludGVydmFsID0ge307XG5cbiAgJHNjb3BlLmFkZEludGVydmFsUHJvamVjdCA9IGZ1bmN0aW9uIChuZXdJbnRlcnZhbCkge1xuICAgICAgUHJvamVjdHNTdmMucG9zdEludGVydmFsUHJvamVjdChuZXdJbnRlcnZhbCkudGhlbihmdW5jdGlvbihyZXN1bHRzKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiTmV3IFNjaGVkdWxlZCBQcm9qZWN0IGFkZGVkXCIsIHJlc3VsdHMpO1xuICAgICAgICAkc2NvcGUudGVtcGxhdGVJRCA9IHJlc3VsdHMuZGF0YS5faWQ7XG4gICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS50ZW1wbGF0ZUlEKTtcbiAgICAgICAgLy8gJHN0YXRlLmdvKCd0ZW1wbGF0ZVRhc2tzJywge1wiaWRcIjogdGVtcGxhdGVJRH0pO1xuICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLmFsZXJ0cy5wdXNoKHttc2c6IFwiUHJvamVjdCBJRCBDcmVhdGVkXCIsIHR5cGU6IFwic3VjY2Vzc1wifSk7XG4gICAgICB9KS5jYXRjaChmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgJHNjb3BlLmFsZXJ0cy5wdXNoKHttc2c6IFwiRmFpbGVkIHRvIENyZWF0ZSBQcm9qZWN0XCIsIHR5cGU6IFwiZGFuZ2VyXCJ9KTtcbiAgICAgIH0pO1xuICAgICAgJHNjb3BlLnNob3dUaGVSZXN0ID0gdHJ1ZTtcbiAgfTtcblxuICAkc2NvcGUuc2luZ2xlUHJvamVjdCA9IHt9O1xuXG4gICRzY29wZS5hZGRTaW5nbGVQcm9qZWN0ID0gZnVuY3Rpb24gKHNpbmdsZVByb2plY3QpIHtcbiAgICAgIFByb2plY3RzU3ZjLnBvc3RTaW5nbGVQcm9qZWN0KHNpbmdsZVByb2plY3QpLnRoZW4oZnVuY3Rpb24ocmVzdWx0cykge1xuICAgICAgICBjb25zb2xlLmxvZyhcIk5ldyBTaW5nbGUgUHJvamVjdCBhZGRlZFwiLCByZXN1bHRzKTtcbiAgICAgICAgJHNjb3BlLnRlbXBsYXRlSUQgPSByZXN1bHRzLmRhdGEuX2lkO1xuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUudGVtcGxhdGVJRCk7XG4gICAgICAgIC8vICRzdGF0ZS5nbygndGVtcGxhdGVUYXNrcycsIHtcImlkXCI6IHRlbXBsYXRlSUR9KTtcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICRzY29wZS5hbGVydHMucHVzaCh7bXNnOiBcIlByb2plY3QgSUQgQ3JlYXRlZFwiLCB0eXBlOiBcInN1Y2Nlc3NcIn0pO1xuICAgICAgfSkuY2F0Y2goZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICRzY29wZS5hbGVydHMucHVzaCh7bXNnOiBcIkZhaWxlZCB0byBDcmVhdGUgUHJvamVjdFwiLCB0eXBlOiBcImRhbmdlclwifSk7XG4gICAgICB9KTtcbiAgICAgICRzY29wZS5zaG93VGhlUmVzdCA9IHRydWU7XG4gIH07XG5cbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
