'use strict';

angular.module('terminatorApp').controller('NewRecurringProjectCtrl', function ($scope, ProjectsSvc, $state) {

  $scope.newRecurringForm = {
    setup: {
      type: "Scheduled"
    }
  };

  $scope.showTheRest = false;

  $scope.selected = "";
  $scope.test = "The Recurring project ctrl is working!";

  $scope.allowedIntervalTypes = ['Daily', 'Daily Business Days', 'Weekly', 'Bi-Weekly', 'Monthly', 'Quarterly', 'Annually'];
  $scope.allowedDays = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
  $scope.allowedWeeklyIntervals = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday', 'Any'];
  $scope.allowedMonthlyIntervals = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
  //$scope.allowedSemiMonthlyIntervals = ["1st","2nd", "3rd", "4th", "5th","6th","7th","8th","9th","10th","11th","12th","13th","14th","15th"];
  $scope.allowedQuarterlyIntervals = ["First Day of the Quarter", "Last Day of the Quarter", "# Days from Start", "# Days from End"]; //Any was removed because it is implied if they don't care
  $scope.allowedAnnuallyIntervals = ["First Day of the Year", "Last Day of the Year", "Any Day of the year", "In a Particular Month", "In a Particular Quarter", "# of Days From Start", "# of Days Before End"];

  $scope.monthlyOptions = [{
    name: "First Day of Month",
    value: "First Day of Month"
  }, {
    name: "Last Day of Month",
    value: "Last Day of Month"
  }, {
    name: "# of Days from Beginning",
    value: "# of Days From Start"
  }, {
    name: "# of Days from End",
    value: "# of Days Before End"
  }];

  $scope.addRecurringProject = function (newRecurringForm) {
    ProjectsSvc.postRecurringProject(newRecurringForm).then(function (results) {
      console.log("New Recurring Project added", results);
      $scope.templateID = results.data._id;
      console.log($scope.templateID);
      $state.go('dashboard.templateView', { id: results.data._id });
    }).catch(function (err) {
      console.log("Error", err);
    });
  };

  $scope.newTasksArr = [];

  $scope.newTask = {
    name: '',
    description: '',
    assignment: {
      departments: '',
      positions: '',
      employees: ''
    }
  };

  $scope.saveTask = function (newTask) {
    newTask.associatedTemplate = $scope.templateID;
    console.log(newTask);
    if (newTask.assignment.departments) newTask.assignment.departments = newTask.assignment.departments._id;
    if (newTask.assignment.positions) newTask.assignment.positions = newTask.assignment.positions._id;
    if (newTask.assignment.employees) newTask.assignment.employee = newTask.assignment.employee._id;
    $scope.newTasksArr.push(newTask);
    console.log("newTasksArr", $scope.newTasksArr);
    $scope.newTask = {
      name: '',
      description: '',
      assignment: {
        departments: '',
        positions: '',
        employees: ''
      }
    };
    // $scope.selectedAssign = null; tryig to clear drop downs with this.
  };

  $scope.addTasks = function (newTasksArr) {
    ProjectsSvc.postTasks(newTasksArr, $scope.templateID).then(function (results) {
      console.log("Tasks added successfully", results);
      // $state.go('projects');
    });
    $scope.newTasksArr = [];
  };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInB1YmxpYy9jb250cm9sbGVycy9OZXdSZWN1cnJpbmdQcm9qZWN0Q3RybC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLE9BQU8sQ0FBQyxNQUFNLENBQUMsZUFBZSxDQUFDLENBQUMsVUFBVSxDQUFDLHlCQUF5QixFQUFFLFVBQVMsTUFBTSxFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQUU7O0FBRTFHLFFBQU0sQ0FBQyxnQkFBZ0IsR0FBRztBQUN4QixTQUFLLEVBQUU7QUFDTCxVQUFJLEVBQUUsV0FBVztLQUNsQjtHQUNGLENBQUM7O0FBRUYsUUFBTSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7O0FBRTNCLFFBQU0sQ0FBQyxRQUFRLEdBQUUsRUFBRSxDQUFDO0FBQ3BCLFFBQU0sQ0FBQyxJQUFJLEdBQUcsd0NBQXdDLENBQUM7O0FBRXZELFFBQU0sQ0FBQyxvQkFBb0IsR0FBRyxDQUFDLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxRQUFRLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxXQUFXLEVBQUUsVUFBVSxDQUFDLENBQUM7QUFDMUgsUUFBTSxDQUFDLFdBQVcsR0FBRyxDQUFDLFFBQVEsRUFBQyxRQUFRLEVBQUMsU0FBUyxFQUFDLFdBQVcsRUFBQyxVQUFVLEVBQUMsUUFBUSxFQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQzlGLFFBQU0sQ0FBQyxzQkFBc0IsR0FBRyxDQUFDLFFBQVEsRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxLQUFLLENBQUMsQ0FBQztBQUN0SCxRQUFNLENBQUMsdUJBQXVCLEdBQUcsQ0FBQyxTQUFTLEVBQUUsVUFBVSxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLFdBQVcsRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLFVBQVUsQ0FBQzs7QUFBQyxBQUU1SixRQUFNLENBQUMseUJBQXlCLEdBQUcsQ0FBQywwQkFBMEIsRUFBRSx5QkFBeUIsRUFBRSxtQkFBbUIsRUFBRSxpQkFBaUIsQ0FBQztBQUFDLEFBQ25JLFFBQU0sQ0FBQyx3QkFBd0IsR0FBRyxDQUFDLHVCQUF1QixFQUFFLHNCQUFzQixFQUFFLHFCQUFxQixFQUFFLHVCQUF1QixFQUFFLHlCQUF5QixFQUFFLHNCQUFzQixFQUFFLHNCQUFzQixDQUFDLENBQUM7O0FBRS9NLFFBQU0sQ0FBQyxjQUFjLEdBQUcsQ0FDdEI7QUFDRSxRQUFJLEVBQUUsb0JBQW9CO0FBQzFCLFNBQUssRUFBRSxvQkFBb0I7R0FDNUIsRUFDRDtBQUNFLFFBQUksRUFBRSxtQkFBbUI7QUFDekIsU0FBSyxFQUFFLG1CQUFtQjtHQUMzQixFQUNEO0FBQ0UsUUFBSSxFQUFFLDBCQUEwQjtBQUNoQyxTQUFLLEVBQUUsc0JBQXNCO0dBQzlCLEVBQ0Q7QUFDRSxRQUFJLEVBQUUsb0JBQW9CO0FBQzFCLFNBQUssRUFBRSxzQkFBc0I7R0FDOUIsQ0FDRixDQUFDOztBQUVGLFFBQU0sQ0FBQyxtQkFBbUIsR0FBRyxVQUFVLGdCQUFnQixFQUFFO0FBQ3JELGVBQVcsQ0FBQyxvQkFBb0IsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUNqRCxJQUFJLENBQUMsVUFBUyxPQUFPLEVBQUU7QUFDdEIsYUFBTyxDQUFDLEdBQUcsQ0FBQyw2QkFBNkIsRUFBRSxPQUFPLENBQUMsQ0FBQztBQUNwRCxZQUFNLENBQUMsVUFBVSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO0FBQ3JDLGFBQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQy9CLFlBQU0sQ0FBQyxFQUFFLENBQUMsd0JBQXdCLEVBQUUsRUFBQyxFQUFFLEVBQUUsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUMsQ0FBQyxDQUFDO0tBQzdELENBQUMsQ0FBQyxLQUFLLENBQUMsVUFBUyxHQUFHLEVBQUU7QUFDckIsYUFBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQUM7S0FDM0IsQ0FBQyxDQUFDO0dBQ04sQ0FBQzs7QUFJRixRQUFNLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQzs7QUFFeEIsUUFBTSxDQUFDLE9BQU8sR0FBRztBQUNYLFFBQUksRUFBRSxFQUFFO0FBQ1IsZUFBVyxFQUFFLEVBQUU7QUFDZixjQUFVLEVBQUU7QUFDVixpQkFBVyxFQUFFLEVBQUU7QUFDZixlQUFTLEVBQUUsRUFBRTtBQUNiLGVBQVMsRUFBRSxFQUFFO0tBQ2Q7R0FDRixDQUFDOztBQUVOLFFBQU0sQ0FBQyxRQUFRLEdBQUcsVUFBUyxPQUFPLEVBQUU7QUFDbEMsV0FBTyxDQUFDLGtCQUFrQixHQUFHLE1BQU0sQ0FBQyxVQUFVLENBQUM7QUFDL0MsV0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUNyQixRQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsV0FBVyxFQUFFLE9BQU8sQ0FBQyxVQUFVLENBQUMsV0FBVyxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQztBQUN2RyxRQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxVQUFVLENBQUMsU0FBUyxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQztBQUNqRyxRQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxVQUFVLENBQUMsUUFBUSxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQztBQUMvRixVQUFNLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUNqQyxXQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDL0MsVUFBTSxDQUFDLE9BQU8sR0FBRztBQUNmLFVBQUksRUFBRSxFQUFFO0FBQ1IsaUJBQVcsRUFBRSxFQUFFO0FBQ2YsZ0JBQVUsRUFBRTtBQUNWLG1CQUFXLEVBQUUsRUFBRTtBQUNmLGlCQUFTLEVBQUUsRUFBRTtBQUNiLGlCQUFTLEVBQUUsRUFBRTtPQUNkO0tBQ0Y7O0FBQUMsR0FFSCxDQUFDOztBQUVGLFFBQU0sQ0FBQyxRQUFRLEdBQUcsVUFBUyxXQUFXLEVBQUU7QUFDdEMsZUFBVyxDQUFDLFNBQVMsQ0FBQyxXQUFXLEVBQUUsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFTLE9BQU8sRUFBRTtBQUMzRSxhQUFPLENBQUMsR0FBRyxDQUFDLDBCQUEwQixFQUFFLE9BQU8sQ0FBQzs7QUFBQyxLQUVsRCxDQUFDLENBQUM7QUFDSCxVQUFNLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQztHQUN6QixDQUFDO0NBRUgsQ0FBQyxDQUFDIiwiZmlsZSI6InB1YmxpYy9jb250cm9sbGVycy9OZXdSZWN1cnJpbmdQcm9qZWN0Q3RybC5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCd0ZXJtaW5hdG9yQXBwJykuY29udHJvbGxlcignTmV3UmVjdXJyaW5nUHJvamVjdEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIFByb2plY3RzU3ZjLCAkc3RhdGUpIHtcblxuICAkc2NvcGUubmV3UmVjdXJyaW5nRm9ybSA9IHtcbiAgICBzZXR1cDoge1xuICAgICAgdHlwZTogXCJTY2hlZHVsZWRcIlxuICAgIH1cbiAgfTtcblxuICAkc2NvcGUuc2hvd1RoZVJlc3QgPSBmYWxzZTtcblxuICAkc2NvcGUuc2VsZWN0ZWQ9IFwiXCI7XG4gICRzY29wZS50ZXN0ID0gXCJUaGUgUmVjdXJyaW5nIHByb2plY3QgY3RybCBpcyB3b3JraW5nIVwiO1xuXG4gICRzY29wZS5hbGxvd2VkSW50ZXJ2YWxUeXBlcyA9IFsnRGFpbHknLCAnRGFpbHkgQnVzaW5lc3MgRGF5cycsICdXZWVrbHknLCAnQmktV2Vla2x5JywgJ01vbnRobHknLCAnUXVhcnRlcmx5JywgJ0FubnVhbGx5J107XG4gICRzY29wZS5hbGxvd2VkRGF5cyA9IFsnU3VuZGF5JywnTW9uZGF5JywnVHVlc2RheScsJ1dlZG5lc2RheScsJ1RodXJzZGF5JywnRnJpZGF5JywnU2F0dXJkYXknXTtcbiAgJHNjb3BlLmFsbG93ZWRXZWVrbHlJbnRlcnZhbHMgPSBbJ01vbmRheScsICdUdWVzZGF5JywgJ1dlZG5lc2RheScsICdUaHVyc2RheScsICdGcmlkYXknLCAnU2F0dXJkYXknLCAnU3VuZGF5JywgJ0FueSddO1xuICAkc2NvcGUuYWxsb3dlZE1vbnRobHlJbnRlcnZhbHMgPSBbJ0phbnVhcnknLCAnRmVicnVhcnknLCAnTWFyY2gnLCAnQXByaWwnLCAnTWF5JywgJ0p1bmUnLCAnSnVseScsICdBdWd1c3QnLCAnU2VwdGVtYmVyJywgJ09jdG9iZXInLCAnTm92ZW1iZXInLCAnRGVjZW1iZXInXTtcbiAgLy8kc2NvcGUuYWxsb3dlZFNlbWlNb250aGx5SW50ZXJ2YWxzID0gW1wiMXN0XCIsXCIybmRcIiwgXCIzcmRcIiwgXCI0dGhcIiwgXCI1dGhcIixcIjZ0aFwiLFwiN3RoXCIsXCI4dGhcIixcIjl0aFwiLFwiMTB0aFwiLFwiMTF0aFwiLFwiMTJ0aFwiLFwiMTN0aFwiLFwiMTR0aFwiLFwiMTV0aFwiXTtcbiAgJHNjb3BlLmFsbG93ZWRRdWFydGVybHlJbnRlcnZhbHMgPSBbXCJGaXJzdCBEYXkgb2YgdGhlIFF1YXJ0ZXJcIiwgXCJMYXN0IERheSBvZiB0aGUgUXVhcnRlclwiLCBcIiMgRGF5cyBmcm9tIFN0YXJ0XCIsIFwiIyBEYXlzIGZyb20gRW5kXCJdOyAvL0FueSB3YXMgcmVtb3ZlZCBiZWNhdXNlIGl0IGlzIGltcGxpZWQgaWYgdGhleSBkb24ndCBjYXJlXG4gICRzY29wZS5hbGxvd2VkQW5udWFsbHlJbnRlcnZhbHMgPSBbXCJGaXJzdCBEYXkgb2YgdGhlIFllYXJcIiwgXCJMYXN0IERheSBvZiB0aGUgWWVhclwiLCBcIkFueSBEYXkgb2YgdGhlIHllYXJcIiwgXCJJbiBhIFBhcnRpY3VsYXIgTW9udGhcIiwgXCJJbiBhIFBhcnRpY3VsYXIgUXVhcnRlclwiLCBcIiMgb2YgRGF5cyBGcm9tIFN0YXJ0XCIsIFwiIyBvZiBEYXlzIEJlZm9yZSBFbmRcIl07XG5cbiAgJHNjb3BlLm1vbnRobHlPcHRpb25zID0gW1xuICAgIHtcbiAgICAgIG5hbWU6IFwiRmlyc3QgRGF5IG9mIE1vbnRoXCIsXG4gICAgICB2YWx1ZTogXCJGaXJzdCBEYXkgb2YgTW9udGhcIlxuICAgIH0sXG4gICAge1xuICAgICAgbmFtZTogXCJMYXN0IERheSBvZiBNb250aFwiLFxuICAgICAgdmFsdWU6IFwiTGFzdCBEYXkgb2YgTW9udGhcIlxuICAgIH0sXG4gICAge1xuICAgICAgbmFtZTogXCIjIG9mIERheXMgZnJvbSBCZWdpbm5pbmdcIixcbiAgICAgIHZhbHVlOiBcIiMgb2YgRGF5cyBGcm9tIFN0YXJ0XCJcbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWU6IFwiIyBvZiBEYXlzIGZyb20gRW5kXCIsXG4gICAgICB2YWx1ZTogXCIjIG9mIERheXMgQmVmb3JlIEVuZFwiXG4gICAgfVxuICBdO1xuXG4gICRzY29wZS5hZGRSZWN1cnJpbmdQcm9qZWN0ID0gZnVuY3Rpb24gKG5ld1JlY3VycmluZ0Zvcm0pIHtcbiAgICAgIFByb2plY3RzU3ZjLnBvc3RSZWN1cnJpbmdQcm9qZWN0KG5ld1JlY3VycmluZ0Zvcm0pXG4gICAgICAudGhlbihmdW5jdGlvbihyZXN1bHRzKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiTmV3IFJlY3VycmluZyBQcm9qZWN0IGFkZGVkXCIsIHJlc3VsdHMpO1xuICAgICAgICAkc2NvcGUudGVtcGxhdGVJRCA9IHJlc3VsdHMuZGF0YS5faWQ7XG4gICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS50ZW1wbGF0ZUlEKTtcbiAgICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmQudGVtcGxhdGVWaWV3Jywge2lkOiByZXN1bHRzLmRhdGEuX2lkfSk7XG4gICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJFcnJvclwiLCBlcnIpO1xuICAgICAgfSk7XG4gIH07XG5cblxuXG4gICRzY29wZS5uZXdUYXNrc0FyciA9IFtdO1xuXG4gICRzY29wZS5uZXdUYXNrID0ge1xuICAgICAgICBuYW1lOiAnJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICcnLFxuICAgICAgICBhc3NpZ25tZW50OiB7XG4gICAgICAgICAgZGVwYXJ0bWVudHM6ICcnLFxuICAgICAgICAgIHBvc2l0aW9uczogJycsXG4gICAgICAgICAgZW1wbG95ZWVzOiAnJ1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICRzY29wZS5zYXZlVGFzayA9IGZ1bmN0aW9uKG5ld1Rhc2spIHtcbiAgICBuZXdUYXNrLmFzc29jaWF0ZWRUZW1wbGF0ZSA9ICRzY29wZS50ZW1wbGF0ZUlEO1xuICAgIGNvbnNvbGUubG9nKG5ld1Rhc2spO1xuICAgIGlmKG5ld1Rhc2suYXNzaWdubWVudC5kZXBhcnRtZW50cykgbmV3VGFzay5hc3NpZ25tZW50LmRlcGFydG1lbnRzID0gbmV3VGFzay5hc3NpZ25tZW50LmRlcGFydG1lbnRzLl9pZDtcbiAgICBpZihuZXdUYXNrLmFzc2lnbm1lbnQucG9zaXRpb25zKSBuZXdUYXNrLmFzc2lnbm1lbnQucG9zaXRpb25zID0gbmV3VGFzay5hc3NpZ25tZW50LnBvc2l0aW9ucy5faWQ7XG4gICAgaWYobmV3VGFzay5hc3NpZ25tZW50LmVtcGxveWVlcykgbmV3VGFzay5hc3NpZ25tZW50LmVtcGxveWVlID0gbmV3VGFzay5hc3NpZ25tZW50LmVtcGxveWVlLl9pZDtcbiAgICAkc2NvcGUubmV3VGFza3NBcnIucHVzaChuZXdUYXNrKTtcbiAgICBjb25zb2xlLmxvZyhcIm5ld1Rhc2tzQXJyXCIsICRzY29wZS5uZXdUYXNrc0Fycik7XG4gICAgJHNjb3BlLm5ld1Rhc2sgPSB7XG4gICAgICBuYW1lOiAnJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnJyxcbiAgICAgIGFzc2lnbm1lbnQ6IHtcbiAgICAgICAgZGVwYXJ0bWVudHM6ICcnLFxuICAgICAgICBwb3NpdGlvbnM6ICcnLFxuICAgICAgICBlbXBsb3llZXM6ICcnXG4gICAgICB9XG4gICAgfTtcbiAgICAvLyAkc2NvcGUuc2VsZWN0ZWRBc3NpZ24gPSBudWxsOyB0cnlpZyB0byBjbGVhciBkcm9wIGRvd25zIHdpdGggdGhpcy5cbiAgfTtcblxuICAkc2NvcGUuYWRkVGFza3MgPSBmdW5jdGlvbihuZXdUYXNrc0Fycikge1xuICAgIFByb2plY3RzU3ZjLnBvc3RUYXNrcyhuZXdUYXNrc0FyciwgJHNjb3BlLnRlbXBsYXRlSUQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0cykge1xuICAgICAgY29uc29sZS5sb2coXCJUYXNrcyBhZGRlZCBzdWNjZXNzZnVsbHlcIiwgcmVzdWx0cyk7XG4gICAgICAvLyAkc3RhdGUuZ28oJ3Byb2plY3RzJyk7XG4gICAgfSk7XG4gICAgJHNjb3BlLm5ld1Rhc2tzQXJyID0gW107XG4gIH07XG5cbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
