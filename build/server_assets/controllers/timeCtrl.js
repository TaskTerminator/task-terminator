'use strict';

//Any day formulas default deadline to last business day
//Specific day formulas allow for full range of user selection

//We need to pass an "instance" argument to accomodate situations where the user may want this task to trigger in within current time period

var mongoose = require('mongoose');
var moment = require('moment');
var daysToDeadline = 7;
var deadlineHour = 17;
//How can set this globally to here? Just putting in an array for now...... this needs to be translated to and array of numbers [0-7] where 0 === Sunday
var businessDays = [0, 1, 2, 3, 4, 5, 6, 7];

var allowedDays = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
var allowedFrequencies = ["Triggered", "Scheduled"];
var allowedIntervalTypes = ['Daily', 'Daily Business Days', 'Weekly', 'Bi-Weekly', 'Monthly', 'Semi-Monthly', 'Quarterly', 'Annually'];
var allowedMonthlyIntervals = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
var allowedAnnuallyIntervals = ["First Day of the Year", "Last Day of the Year", "Any Day of the year", "In a Particular Month", "In a Particular Quarter", "# of Days From Start", "# of Days Before end"];
var allowedWeeklyIntervals = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday', 'Any'];
var allowedSemiMonthlyIntervals = ["1st", "2nd", "3rd", "4th", "5th", "6th", "7th", "8th", "9th", "10th", "11th", "12th", "13th", "14th", "15th"];
var allowedQuarterlyIntervals = ["First Day of the Quarter", "Last Day of the Quarter", "# Days from Start", "# Days from End", "Any"];

module.exports = {

  now: function now() {
    return moment()._d;
  },
  nextDay: function nextDay() {
    return moment().hours(deadlineHour).minute(0).second(0).millisecond(0).add(1, 'days')._d;
  },

  dayOfWeek: function dayOfWeek() {
    return moment().day();
  },

  thisMonth: function thisMonth() {
    return moment().month();
  },

  thisQuarter: function thisQuarter() {
    return moment().quarter();
  },

  thisYear: function thisYear() {
    return moment().year();
  },

  nextMonth: function nextMonth() {
    return moment().month() + 1;
  },

  deadlineToday: function deadlineToday() {
    return moment().hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
  },

  triggeredProjectDeadline: function triggeredProjectDeadline() {
    return moment().hours(deadlineHour).minute(0).second(0).millisecond(0).add(daysToDeadline, 'days')._d;
  },

  dateDeadline: function dateDeadline(date) {
    return moment(date).hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
  },

  weeklyAnyDay: function weeklyAnyDay(instance) {
    //This looks to last business day of week in company settings and puts deadline at the deadline hour of that day each week
    var lastDay = businessDays.sort().reverse()[0];
    var naturalInstance = moment().hours(deadlineHour).minute(0).second(0).millisecond(0).day(lastDay)._d;
    var nextInstance = moment().hours(deadlineHour).minute(0).second(0).millisecond(0).day(lastDay + 7)._d;

    if (moment().isAfter(naturalInstance) === true) {
      return nextInstance;
    } else if (instance === "first") {
      return naturalInstance;
    } else {
      return nextInstance;
    }
  },

  weeklySpecificDay: function weeklySpecificDay(selectedDay, instance) {
    var naturalInstance = moment().hours(deadlineHour).minute(0).second(0).millisecond(0).day(selectedDay)._d;
    var nextInstance = moment().hours(deadlineHour).minute(0).second(0).millisecond(0).day(selectedDay + 7)._d;

    if (moment().isAfter(naturalInstance) === true) {
      return nextInstance;
    } else if (instance === "first") {
      return naturalInstance;
    } else {
      return nextInstance;
    }
  },

  biWeeklyAnyDay: function biWeeklyAnyDay(instance) {
    var lastDay = businessDays.sort().reverse()[0];
    var naturalInstance = moment().hours(deadlineHour).minute(0).second(0).millisecond(0).day(lastDay)._d;
    var nextInstance = moment().hours(deadlineHour).minute(0).second(0).millisecond(0).day(lastDay + 14)._d;
    if (moment().isAfter(naturalInstance) === true) {
      return nextInstance;
    } else if (instance === "first") {
      return naturalInstance;
    } else {
      return nextInstance;
    }
  },

  biWeeklySpecificDay: function biWeeklySpecificDay(selectedDay, instance) {
    var naturalInstance = moment().hours(deadlineHour).minute(0).second(0).millisecond(0).day(selectedDay)._d;
    var nextInstance = moment().hours(deadlineHour).minute(0).second(0).millisecond(0).day(selectedDay + 14)._d;
    if (moment().isAfter(naturalInstance) === true) {
      return nextInstance;
    } else if (instance === "first") {
      return naturalInstance;
    } else {
      return nextInstance;
    }
  },

  monthlyFirstDay: function monthlyFirstDay() {
    var nextMonth = moment().month() + 1;
    return moment().hours(deadlineHour).minute(0).second(0).millisecond(0).month(nextMonth).date(1)._d;
  },

  monthlyLastDay: function monthlyLastDay(instance) {
    if (instance === "first") {
      return moment().endOf("month").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
    } else {
      var nextMonth = moment().month() + 1;
      return moment().month(nextMonth).endOf("month").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
    }
  },

  monthlyAnyDay: function monthlyAnyDay(instance) {
    //defaults deadline to the last day of the month same function as monthlyLastDay.... we could do last business day as a strech
    var nextMonth = moment().month() + 1;
    if (instance === "first") {
      return moment().endOf("month").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
    } else {
      return moment().month(nextMonth).endOf("month").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
    }
  },

  monthlyDaysFromStart: function monthlyDaysFromStart(numDays, instance) {
    var nextMonth = moment().month() + 1;
    var naturalInstance = moment().startOf('month').hours(deadlineHour).minute(0).second(0).millisecond(0).add(numDays - 1, 'days')._d;
    var nextInstance = moment().month(nextMonth).startOf('month').hours(deadlineHour).minute(0).second(0).millisecond(0).add(numDays - 1, 'days')._d;

    if (moment().isAfter(naturalInstance)) {
      return nextInstance;
    } else if (instance === "first") {
      return naturalInstance;
    } else {
      return nextInstance;
    }
  },

  monthlyDaysBeforeEnd: function monthlyDaysBeforeEnd(numDaysBefore, instance) {
    var nextMonth = moment().month() + 1;
    var naturalInstance = moment().endOf("month").subtract(numDaysBefore, "days").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
    var nextInstance = moment().month(nextMonth).endOf("month").subtract(numDaysBefore, "days").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;

    if (moment().isAfter(naturalInstance)) {
      return nextInstance;
    } else if (instance === "first") {
      return naturalInstance;
    } else {
      return nextInstance;
    }
  },

  quarterlyFirstDay: function quarterlyFirstDay() {
    var nextQuarter = moment().quarter() + 1;
    return moment().hours(deadlineHour).minute(0).second(0).millisecond(0).quarter(nextQuarter).date(1)._d;
  },

  quarterlyLastDay: function quarterlyLastDay(instance) {
    var nextQuarter = moment().quarter() + 1;
    var naturalInstance = moment().endOf("quarter").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
    var nextInstance = moment().quarter(nextQuarter).endOf("quarter").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;

    if (moment().isAfter(naturalInstance)) {
      return nextInstance;
    } else if (instance === "first") {
      return naturalInstance;
    } else {
      return nextInstance;
    }
  },

  quarterlyAnyDay: function quarterlyAnyDay(instance) {
    var nextQuarter = moment().quarter() + 1;
    var naturalInstance = moment().endOf("quarter").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
    var nextInstance = moment().quarter(nextQuarter).endOf("quarter").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
    if (moment().isAfter(naturalInstance)) {
      return nextInstance;
    } else if (instance === "first") {
      return naturalInstance;
    } else {
      return nextInstance;
    }
  },

  quarterlyDaysFromStart: function quarterlyDaysFromStart(numDays, instance) {
    var nextQuarter = moment().quarter() + 1;
    var naturalInstance = moment().startOf('quarter').hours(0).seconds(0).millisecond(0).add(numDays, 'days')._d;
    var nextInstance = moment().quarter(nextQuarter).date(1).hours(0).seconds(0).millisecond(0).add(numDays, 'days')._d;

    if (moment().isAfter(naturalInstance) === true) {
      return nextInstance;
    } else if (instance === "first") {
      return naturalInstance;
    } else {
      return nextInstance;
    }
  },

  quarterlyDaysBeforeEnd: function quarterlyDaysBeforeEnd(numDaysBefore, instance) {
    var nextQuarter = moment().quarter() + 1;
    var naturalInstance = moment().endOf("quarter").subtract(numDaysBefore, "days").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
    var nextInstance = moment().quarter(nextQuarter).endOf("quarter").subtract(numDaysBefore, "days").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
    if (moment().isAfter(naturalInstance) === true) {
      return nextInstance;
    } else if (instance === "first") {
      return naturalInstance;
    } else {
      return nextInstance;
    }
  },

  annuallyFirstDay: function annuallyFirstDay(instance) {
    var nextYear = moment().year() + 1;
    return moment().hours(deadlineHour).minute(0).second(0).millisecond(0).year(nextYear).date(1)._d;
  },

  annuallyLastDay: function annuallyLastDay(instance) {
    if (instance === "first") {
      return moment().endOf("year").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
    } else {
      var nextYear = moment().year() + 1;
      return moment().year(nextYear).endOf("year").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
    }
  },

  annuallyAnyDay: function annuallyAnyDay(instance) {
    var nextYear = moment().year() + 1;
    var naturalInstance = moment().endOf("year").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
    var nextInstance = moment().year(nextYear).endOf("year").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;

    if (moment().isAfter(naturalInstance) === true) {
      return nextInstance;
    } else if (instance === "first") {
      return naturalInstance;
    } else {
      return nextInstance;
    }
  },

  annuallyDaysFromStart: function annuallyDaysFromStart(numDays, instance) {
    var nextYear = moment().year() + 1;
    var naturalInstance = moment().startOf('year').hours(0).seconds(0).millisecond(0).add(numDays, 'days')._d;
    var nextInstance = moment().year(nextYear).startOf('year').hours(0).seconds(0).millisecond(0).add(numDays, 'days')._d;

    if (moment().isAfter(naturalInstance) === true) {
      return nextInstance;
    } else if (instance === "first") {
      return naturalInstance;
    } else {
      return nextInstance;
    }
  },

  annuallyDaysBeforeEnd: function annuallyDaysBeforeEnd(numDaysBefore, instance) {
    var nextYear = moment().year() + 1;
    var naturalInstance = moment().endOf("year").subtract(numDaysBefore, "days").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
    var nextInstance = moment().year(nextYear).endOf("year").subtract(numDaysBefore, "days").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;

    if (moment().isAfter(naturalInstance) === true) {
      return nextInstance;
    } else if (instance === "first") {
      return naturalInstance;
    } else {
      return nextInstance;
    }
  },

  annuallyParticularMonth: function annuallyParticularMonth(selectedMonth, instance) {
    console.log("#12 - Made it to annuallyParticularMonth");
    console.log("MONTH", selectedMonth);
    var nextYear = moment().year() + 1;
    var naturalInstance = moment().month(selectedMonth).endOf("month").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
    var nextInstance = moment().year(nextYear).month(selectedMonth).endOf("month").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;

    if (moment().isAfter(naturalInstance) === true) {
      console.log('!!!!!!');
      return nextInstance;
    } else if (instance === "first") {
      return naturalInstance;
    } else {
      console.log('??????');
      return nextInstance;
    }
  },

  annuallyParticularQuarter: function annuallyParticularQuarter(selectedQuarter, instance) {
    var nextYear = moment().year() + 1;
    var naturalInstance = moment().quarter(selectedQuarter).endOf("quarter").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;
    var nextInstance = moment().year(nextYear).quarter(selectedQuarter).endOf("quarter").hours(deadlineHour).minute(0).second(0).millisecond(0)._d;

    if (moment().isAfter(naturalInstance) === true) {
      return nextInstance;
    } else if (instance === "first") {
      return naturalInstance;
    } else {
      return nextInstance;
    }
  },

  semiMonthlyFirstCycle: function semiMonthlyFirstCycle(selectedDate) {
    return moment().hours(deadlineHour).minute(0).second(0).millisecond(0).date(selectedDate)._d;
  },

  semiMothlySecondCycle: function semiMothlySecondCycle(firstCycleDate) {
    return moment().hours(deadlineHour).minute(0).second(0).millisecond(0).date(firstCycleDate + 15)._d;
  },

  nextBusinessDay: function nextBusinessDay() {
    var isIn = function isIn(increaseDays) {
      //Sets a number for day of the week...Sunday = 0, Monday = 1 etc.
      var today = moment().day();
      var nextBD = today + increaseDays;
      var flag = false;
      for (var i = 1; i < 6; i++) {
        if (i === nextBD) {
          flag = true;
        }
      }
      return flag;
    };
    if (isIn(1) === true) {
      return moment().hours(deadlineHour).minute(0).second(0).millisecond(0).add(1, 'days')._d;
    }
    return moment().hours(deadlineHour).minute(0).second(0).millisecond(0).add(1, "weeks").startOf('isoWeek')._d;
  }

};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlcl9hc3NldHMvY29udHJvbGxlcnMvdGltZUN0cmwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUtBLElBQU0sUUFBUSxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUNyQyxJQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDakMsSUFBTSxjQUFjLEdBQUcsQ0FBQyxDQUFDO0FBQ3pCLElBQU0sWUFBWSxHQUFHLEVBQUU7O0FBQUMsQUFFeEIsSUFBTSxZQUFZLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7O0FBRTlDLElBQU0sV0FBVyxHQUFHLENBQUMsUUFBUSxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsVUFBVSxDQUFDLENBQUM7QUFDbkcsSUFBTSxrQkFBa0IsR0FBRyxDQUFDLFdBQVcsRUFBRSxXQUFXLENBQUMsQ0FBQztBQUN0RCxJQUFNLG9CQUFvQixHQUFHLENBQUMsT0FBTyxFQUFFLHFCQUFxQixFQUFFLFFBQVEsRUFBRSxXQUFXLEVBQUUsU0FBUyxFQUFFLGNBQWMsRUFBRSxXQUFXLEVBQUUsVUFBVSxDQUFDLENBQUM7QUFDekksSUFBTSx1QkFBdUIsR0FBRyxDQUFDLFNBQVMsRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsVUFBVSxDQUFDLENBQUM7QUFDM0osSUFBTSx3QkFBd0IsR0FBRyxDQUFDLHVCQUF1QixFQUFFLHNCQUFzQixFQUFFLHFCQUFxQixFQUFFLHVCQUF1QixFQUFFLHlCQUF5QixFQUFFLHNCQUFzQixFQUFFLHNCQUFzQixDQUFDLENBQUM7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cy9jb250cm9sbGVycy90aW1lQ3RybC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vQW55IGRheSBmb3JtdWxhcyBkZWZhdWx0IGRlYWRsaW5lIHRvIGxhc3QgYnVzaW5lc3MgZGF5XG4vL1NwZWNpZmljIGRheSBmb3JtdWxhcyBhbGxvdyBmb3IgZnVsbCByYW5nZSBvZiB1c2VyIHNlbGVjdGlvblxuXG4vL1dlIG5lZWQgdG8gcGFzcyBhbiBcImluc3RhbmNlXCIgYXJndW1lbnQgdG8gYWNjb21vZGF0ZSBzaXR1YXRpb25zIHdoZXJlIHRoZSB1c2VyIG1heSB3YW50IHRoaXMgdGFzayB0byB0cmlnZ2VyIGluIHdpdGhpbiBjdXJyZW50IHRpbWUgcGVyaW9kXG5cbmNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTtcbmNvbnN0IG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpO1xuY29uc3QgZGF5c1RvRGVhZGxpbmUgPSA3O1xuY29uc3QgZGVhZGxpbmVIb3VyID0gMTc7XG4vL0hvdyBjYW4gc2V0IHRoaXMgZ2xvYmFsbHkgdG8gaGVyZT8gSnVzdCBwdXR0aW5nIGluIGFuIGFycmF5IGZvciBub3cuLi4uLi4gdGhpcyBuZWVkcyB0byBiZSB0cmFuc2xhdGVkIHRvIGFuZCBhcnJheSBvZiBudW1iZXJzIFswLTddIHdoZXJlIDAgPT09IFN1bmRheVxuY29uc3QgYnVzaW5lc3NEYXlzID0gWzAsIDEsIDIsIDMsIDQsIDUsIDYsIDddO1xuXG5jb25zdCBhbGxvd2VkRGF5cyA9IFsnU3VuZGF5JywgJ01vbmRheScsICdUdWVzZGF5JywgJ1dlZG5lc2RheScsICdUaHVyc2RheScsICdGcmlkYXknLCAnU2F0dXJkYXknXTtcbmNvbnN0IGFsbG93ZWRGcmVxdWVuY2llcyA9IFtcIlRyaWdnZXJlZFwiLCBcIlNjaGVkdWxlZFwiXTtcbmNvbnN0IGFsbG93ZWRJbnRlcnZhbFR5cGVzID0gWydEYWlseScsICdEYWlseSBCdXNpbmVzcyBEYXlzJywgJ1dlZWtseScsICdCaS1XZWVrbHknLCAnTW9udGhseScsICdTZW1pLU1vbnRobHknLCAnUXVhcnRlcmx5JywgJ0FubnVhbGx5J107XG5jb25zdCBhbGxvd2VkTW9udGhseUludGVydmFscyA9IFsnSmFudWFyeScsICdGZWJydWFyeScsICdNYXJjaCcsICdBcHJpbCcsICdNYXknLCAnSnVuZScsICdKdWx5JywgJ0F1Z3VzdCcsICdTZXB0ZW1iZXInLCAnT2N0b2JlcicsICdOb3ZlbWJlcicsICdEZWNlbWJlciddO1xuY29uc3QgYWxsb3dlZEFubnVhbGx5SW50ZXJ2YWxzID0gW1wiRmlyc3QgRGF5IG9mIHRoZSBZZWFyXCIsIFwiTGFzdCBEYXkgb2YgdGhlIFllYXJcIiwgXCJBbnkgRGF5IG9mIHRoZSB5ZWFyXCIsIFwiSW4gYSBQYXJ0aWN1bGFyIE1vbnRoXCIsIFwiSW4gYSBQYXJ0aWN1bGFyIFF1YXJ0ZXJcIiwgXCIjIG9mIERheXMgRnJvbSBTdGFydFwiLCBcIiMgb2YgRGF5cyBCZWZvcmUgZW5kXCJdO1xuY29uc3QgYWxsb3dlZFdlZWtseUludGVydmFscyA9IFsnTW9uZGF5JywgJ1R1ZXNkYXknLCAnV2VkbmVzZGF5JywgJ1RodXJzZGF5JywgJ0ZyaWRheScsICdTYXR1cmRheScsICdTdW5kYXknLCAnQW55J107XG5jb25zdCBhbGxvd2VkU2VtaU1vbnRobHlJbnRlcnZhbHMgPSBbXCIxc3RcIiwgXCIybmRcIiwgXCIzcmRcIiwgXCI0dGhcIiwgXCI1dGhcIiwgXCI2dGhcIiwgXCI3dGhcIiwgXCI4dGhcIiwgXCI5dGhcIiwgXCIxMHRoXCIsIFwiMTF0aFwiLCBcIjEydGhcIiwgXCIxM3RoXCIsIFwiMTR0aFwiLCBcIjE1dGhcIl07XG5jb25zdCBhbGxvd2VkUXVhcnRlcmx5SW50ZXJ2YWxzID0gW1wiRmlyc3QgRGF5IG9mIHRoZSBRdWFydGVyXCIsIFwiTGFzdCBEYXkgb2YgdGhlIFF1YXJ0ZXJcIiwgXCIjIERheXMgZnJvbSBTdGFydFwiLCBcIiMgRGF5cyBmcm9tIEVuZFwiLCBcIkFueVwiXTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuICBub3c6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBtb21lbnQoKS5fZDtcbiAgfSxcbiAgICBuZXh0RGF5OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIG1vbWVudCgpLmhvdXJzKGRlYWRsaW5lSG91cikubWludXRlKDApLnNlY29uZCgwKS5taWxsaXNlY29uZCgwKS5hZGQoMSwgJ2RheXMnKS5fZDtcbiAgICB9LFxuXG4gIGRheU9mV2VlazogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG1vbWVudCgpLmRheSgpO1xuICB9LFxuXG4gIHRoaXNNb250aDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG1vbWVudCgpLm1vbnRoKCk7XG4gIH0sXG5cbiAgdGhpc1F1YXJ0ZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBtb21lbnQoKS5xdWFydGVyKCk7XG4gIH0sXG5cbiAgdGhpc1llYXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBtb21lbnQoKS55ZWFyKCk7XG4gIH0sXG5cbiAgbmV4dE1vbnRoOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbW9tZW50KCkubW9udGgoKSArIDE7XG4gIH0sXG5cbiAgZGVhZGxpbmVUb2RheTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG1vbWVudCgpLmhvdXJzKGRlYWRsaW5lSG91cikubWludXRlKDApLnNlY29uZCgwKS5taWxsaXNlY29uZCgwKS5fZDtcbiAgfSxcblxuICB0cmlnZ2VyZWRQcm9qZWN0RGVhZGxpbmU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBtb21lbnQoKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuYWRkKGRheXNUb0RlYWRsaW5lLCAnZGF5cycpLl9kO1xuICB9LFxuXG4gIGRhdGVEZWFkbGluZTogZnVuY3Rpb24oZGF0ZSkge1xuICAgIHJldHVybiBtb21lbnQoZGF0ZSkuaG91cnMoZGVhZGxpbmVIb3VyKS5taW51dGUoMCkuc2Vjb25kKDApLm1pbGxpc2Vjb25kKDApLl9kO1xuICB9LFxuXG5cblxuICB3ZWVrbHlBbnlEYXk6IGZ1bmN0aW9uKGluc3RhbmNlKSB7XG4gICAgLy9UaGlzIGxvb2tzIHRvIGxhc3QgYnVzaW5lc3MgZGF5IG9mIHdlZWsgaW4gY29tcGFueSBzZXR0aW5ncyBhbmQgcHV0cyBkZWFkbGluZSBhdCB0aGUgZGVhZGxpbmUgaG91ciBvZiB0aGF0IGRheSBlYWNoIHdlZWtcbiAgICBjb25zdCBsYXN0RGF5ID0gYnVzaW5lc3NEYXlzLnNvcnQoKS5yZXZlcnNlKClbMF07XG4gICAgY29uc3QgbmF0dXJhbEluc3RhbmNlID0gbW9tZW50KCkuaG91cnMoZGVhZGxpbmVIb3VyKS5taW51dGUoMCkuc2Vjb25kKDApLm1pbGxpc2Vjb25kKDApLmRheShsYXN0RGF5KS5fZDtcbiAgICBjb25zdCBuZXh0SW5zdGFuY2UgPSBtb21lbnQoKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuZGF5KGxhc3REYXkgKyA3KS5fZDtcblxuICAgIGlmIChtb21lbnQoKS5pc0FmdGVyKG5hdHVyYWxJbnN0YW5jZSkgPT09IHRydWUpIHtcbiAgICAgIHJldHVybiBuZXh0SW5zdGFuY2U7XG4gICAgfSBlbHNlIGlmIChpbnN0YW5jZSA9PT0gXCJmaXJzdFwiKSB7XG4gICAgICByZXR1cm4gbmF0dXJhbEluc3RhbmNlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbmV4dEluc3RhbmNlO1xuICAgIH1cbiAgfSxcblxuICB3ZWVrbHlTcGVjaWZpY0RheTogZnVuY3Rpb24oc2VsZWN0ZWREYXksIGluc3RhbmNlKSB7XG4gICAgY29uc3QgbmF0dXJhbEluc3RhbmNlID0gbW9tZW50KCkuaG91cnMoZGVhZGxpbmVIb3VyKS5taW51dGUoMCkuc2Vjb25kKDApLm1pbGxpc2Vjb25kKDApLmRheShzZWxlY3RlZERheSkuX2Q7XG4gICAgY29uc3QgbmV4dEluc3RhbmNlID0gbW9tZW50KCkuaG91cnMoZGVhZGxpbmVIb3VyKS5taW51dGUoMCkuc2Vjb25kKDApLm1pbGxpc2Vjb25kKDApLmRheShzZWxlY3RlZERheSArIDcpLl9kO1xuXG4gICAgaWYgKG1vbWVudCgpLmlzQWZ0ZXIobmF0dXJhbEluc3RhbmNlKSA9PT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIG5leHRJbnN0YW5jZTtcbiAgICB9IGVsc2UgaWYgKGluc3RhbmNlID09PSBcImZpcnN0XCIpIHtcbiAgICAgIHJldHVybiBuYXR1cmFsSW5zdGFuY2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBuZXh0SW5zdGFuY2U7XG4gICAgfVxuICB9LFxuXG4gIGJpV2Vla2x5QW55RGF5OiBmdW5jdGlvbihpbnN0YW5jZSkge1xuICAgIGNvbnN0IGxhc3REYXkgPSBidXNpbmVzc0RheXMuc29ydCgpLnJldmVyc2UoKVswXTtcbiAgICBjb25zdCBuYXR1cmFsSW5zdGFuY2UgPSBtb21lbnQoKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuZGF5KGxhc3REYXkpLl9kO1xuICAgIGNvbnN0IG5leHRJbnN0YW5jZSA9IG1vbWVudCgpLmhvdXJzKGRlYWRsaW5lSG91cikubWludXRlKDApLnNlY29uZCgwKS5taWxsaXNlY29uZCgwKS5kYXkobGFzdERheSArIDE0KS5fZDtcbiAgICBpZiAobW9tZW50KCkuaXNBZnRlcihuYXR1cmFsSW5zdGFuY2UpID09PSB0cnVlKSB7XG4gICAgICByZXR1cm4gbmV4dEluc3RhbmNlO1xuICAgIH0gZWxzZSBpZiAoaW5zdGFuY2UgPT09IFwiZmlyc3RcIikge1xuICAgICAgcmV0dXJuIG5hdHVyYWxJbnN0YW5jZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG5leHRJbnN0YW5jZTtcbiAgICB9XG4gIH0sXG5cbiAgYmlXZWVrbHlTcGVjaWZpY0RheTogZnVuY3Rpb24oc2VsZWN0ZWREYXksIGluc3RhbmNlKSB7XG4gICAgY29uc3QgbmF0dXJhbEluc3RhbmNlID0gbW9tZW50KCkuaG91cnMoZGVhZGxpbmVIb3VyKS5taW51dGUoMCkuc2Vjb25kKDApLm1pbGxpc2Vjb25kKDApLmRheShzZWxlY3RlZERheSkuX2Q7XG4gICAgY29uc3QgbmV4dEluc3RhbmNlID0gbW9tZW50KCkuaG91cnMoZGVhZGxpbmVIb3VyKS5taW51dGUoMCkuc2Vjb25kKDApLm1pbGxpc2Vjb25kKDApLmRheShzZWxlY3RlZERheSArIDE0KS5fZDtcbiAgICBpZiAobW9tZW50KCkuaXNBZnRlcihuYXR1cmFsSW5zdGFuY2UpID09PSB0cnVlKSB7XG4gICAgICByZXR1cm4gbmV4dEluc3RhbmNlO1xuICAgIH0gZWxzZSBpZiAoaW5zdGFuY2UgPT09IFwiZmlyc3RcIikge1xuICAgICAgcmV0dXJuIG5hdHVyYWxJbnN0YW5jZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG5leHRJbnN0YW5jZTtcbiAgICB9XG4gIH0sXG5cbiAgbW9udGhseUZpcnN0RGF5OiBmdW5jdGlvbigpIHtcbiAgICBjb25zdCBuZXh0TW9udGggPSBtb21lbnQoKS5tb250aCgpICsgMTtcbiAgICByZXR1cm4gbW9tZW50KCkuaG91cnMoZGVhZGxpbmVIb3VyKS5taW51dGUoMCkuc2Vjb25kKDApLm1pbGxpc2Vjb25kKDApLm1vbnRoKG5leHRNb250aCkuZGF0ZSgxKS5fZDtcbiAgfSxcblxuICBtb250aGx5TGFzdERheTogZnVuY3Rpb24oaW5zdGFuY2UpIHtcbiAgICBpZiAoaW5zdGFuY2UgPT09IFwiZmlyc3RcIikge1xuICAgICAgcmV0dXJuIG1vbWVudCgpLmVuZE9mKFwibW9udGhcIikuaG91cnMoZGVhZGxpbmVIb3VyKS5taW51dGUoMCkuc2Vjb25kKDApLm1pbGxpc2Vjb25kKDApLl9kO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBuZXh0TW9udGggPSBtb21lbnQoKS5tb250aCgpICsgMTtcbiAgICAgIHJldHVybiBtb21lbnQoKS5tb250aChuZXh0TW9udGgpLmVuZE9mKFwibW9udGhcIikuaG91cnMoZGVhZGxpbmVIb3VyKS5taW51dGUoMCkuc2Vjb25kKDApLm1pbGxpc2Vjb25kKDApLl9kO1xuICAgIH1cbiAgfSxcblxuICBtb250aGx5QW55RGF5OiBmdW5jdGlvbihpbnN0YW5jZSkge1xuICAgIC8vZGVmYXVsdHMgZGVhZGxpbmUgdG8gdGhlIGxhc3QgZGF5IG9mIHRoZSBtb250aCBzYW1lIGZ1bmN0aW9uIGFzIG1vbnRobHlMYXN0RGF5Li4uLiB3ZSBjb3VsZCBkbyBsYXN0IGJ1c2luZXNzIGRheSBhcyBhIHN0cmVjaFxuICAgIGNvbnN0IG5leHRNb250aCA9IG1vbWVudCgpLm1vbnRoKCkgKyAxO1xuICAgIGlmIChpbnN0YW5jZSA9PT0gXCJmaXJzdFwiKSB7XG4gICAgICByZXR1cm4gbW9tZW50KCkuZW5kT2YoXCJtb250aFwiKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuX2Q7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBtb21lbnQoKS5tb250aChuZXh0TW9udGgpLmVuZE9mKFwibW9udGhcIikuaG91cnMoZGVhZGxpbmVIb3VyKS5taW51dGUoMCkuc2Vjb25kKDApLm1pbGxpc2Vjb25kKDApLl9kO1xuICAgIH1cbiAgfSxcblxuICBtb250aGx5RGF5c0Zyb21TdGFydDogZnVuY3Rpb24obnVtRGF5cywgaW5zdGFuY2UpIHtcbiAgICBjb25zdCBuZXh0TW9udGggPSBtb21lbnQoKS5tb250aCgpICsgMTtcbiAgICBjb25zdCBuYXR1cmFsSW5zdGFuY2UgPSBtb21lbnQoKS5zdGFydE9mKCdtb250aCcpLmhvdXJzKGRlYWRsaW5lSG91cikubWludXRlKDApLnNlY29uZCgwKS5taWxsaXNlY29uZCgwKS5hZGQobnVtRGF5cyAtIDEsICdkYXlzJykuX2Q7XG4gICAgY29uc3QgbmV4dEluc3RhbmNlID0gbW9tZW50KCkubW9udGgobmV4dE1vbnRoKS5zdGFydE9mKCdtb250aCcpLmhvdXJzKGRlYWRsaW5lSG91cikubWludXRlKDApLnNlY29uZCgwKS5taWxsaXNlY29uZCgwKS5hZGQobnVtRGF5cyAtIDEsICdkYXlzJykuX2Q7XG5cbiAgICBpZiAobW9tZW50KCkuaXNBZnRlcihuYXR1cmFsSW5zdGFuY2UpKSB7XG4gICAgICByZXR1cm4gbmV4dEluc3RhbmNlO1xuICAgIH0gZWxzZSBpZiAoaW5zdGFuY2UgPT09IFwiZmlyc3RcIikge1xuICAgICAgcmV0dXJuIG5hdHVyYWxJbnN0YW5jZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG5leHRJbnN0YW5jZTtcbiAgICB9XG4gIH0sXG5cblxuICBtb250aGx5RGF5c0JlZm9yZUVuZDogZnVuY3Rpb24obnVtRGF5c0JlZm9yZSwgaW5zdGFuY2UpIHtcbiAgICBjb25zdCBuZXh0TW9udGggPSBtb21lbnQoKS5tb250aCgpICsgMTtcbiAgICBjb25zdCBuYXR1cmFsSW5zdGFuY2UgPSBtb21lbnQoKS5lbmRPZihcIm1vbnRoXCIpLnN1YnRyYWN0KG51bURheXNCZWZvcmUsIFwiZGF5c1wiKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuX2Q7XG4gICAgY29uc3QgbmV4dEluc3RhbmNlID0gbW9tZW50KCkubW9udGgobmV4dE1vbnRoKS5lbmRPZihcIm1vbnRoXCIpLnN1YnRyYWN0KG51bURheXNCZWZvcmUsIFwiZGF5c1wiKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuX2Q7XG5cbiAgICBpZiAobW9tZW50KCkuaXNBZnRlcihuYXR1cmFsSW5zdGFuY2UpKSB7XG4gICAgICByZXR1cm4gbmV4dEluc3RhbmNlO1xuICAgIH0gZWxzZSBpZiAoaW5zdGFuY2UgPT09IFwiZmlyc3RcIikge1xuICAgICAgcmV0dXJuIG5hdHVyYWxJbnN0YW5jZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG5leHRJbnN0YW5jZTtcbiAgICB9XG5cbiAgfSxcblxuXG4gIHF1YXJ0ZXJseUZpcnN0RGF5OiBmdW5jdGlvbigpIHtcbiAgICBjb25zdCBuZXh0UXVhcnRlciA9IG1vbWVudCgpLnF1YXJ0ZXIoKSArIDE7XG4gICAgcmV0dXJuIG1vbWVudCgpLmhvdXJzKGRlYWRsaW5lSG91cikubWludXRlKDApLnNlY29uZCgwKS5taWxsaXNlY29uZCgwKS5xdWFydGVyKG5leHRRdWFydGVyKS5kYXRlKDEpLl9kO1xuICB9LFxuXG4gIHF1YXJ0ZXJseUxhc3REYXk6IGZ1bmN0aW9uKGluc3RhbmNlKSB7XG4gICAgY29uc3QgbmV4dFF1YXJ0ZXIgPSBtb21lbnQoKS5xdWFydGVyKCkgKyAxO1xuICAgIGNvbnN0IG5hdHVyYWxJbnN0YW5jZSA9IG1vbWVudCgpLmVuZE9mKFwicXVhcnRlclwiKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuX2Q7XG4gICAgY29uc3QgbmV4dEluc3RhbmNlID0gbW9tZW50KCkucXVhcnRlcihuZXh0UXVhcnRlcikuZW5kT2YoXCJxdWFydGVyXCIpLmhvdXJzKGRlYWRsaW5lSG91cikubWludXRlKDApLnNlY29uZCgwKS5taWxsaXNlY29uZCgwKS5fZDtcblxuICAgIGlmIChtb21lbnQoKS5pc0FmdGVyKG5hdHVyYWxJbnN0YW5jZSkpIHtcbiAgICAgIHJldHVybiBuZXh0SW5zdGFuY2U7XG4gICAgfSBlbHNlIGlmIChpbnN0YW5jZSA9PT0gXCJmaXJzdFwiKSB7XG4gICAgICByZXR1cm4gbmF0dXJhbEluc3RhbmNlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbmV4dEluc3RhbmNlO1xuICAgIH1cbiAgfSxcblxuICBxdWFydGVybHlBbnlEYXk6IGZ1bmN0aW9uKGluc3RhbmNlKSB7XG4gICAgY29uc3QgbmV4dFF1YXJ0ZXIgPSBtb21lbnQoKS5xdWFydGVyKCkgKyAxO1xuICAgIGNvbnN0IG5hdHVyYWxJbnN0YW5jZSA9IG1vbWVudCgpLmVuZE9mKFwicXVhcnRlclwiKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuX2Q7XG4gICAgY29uc3QgbmV4dEluc3RhbmNlID0gbW9tZW50KCkucXVhcnRlcihuZXh0UXVhcnRlcikuZW5kT2YoXCJxdWFydGVyXCIpLmhvdXJzKGRlYWRsaW5lSG91cikubWludXRlKDApLnNlY29uZCgwKS5taWxsaXNlY29uZCgwKS5fZDtcbiAgICBpZiAobW9tZW50KCkuaXNBZnRlcihuYXR1cmFsSW5zdGFuY2UpKSB7XG4gICAgICByZXR1cm4gbmV4dEluc3RhbmNlO1xuICAgIH0gZWxzZSBpZiAoaW5zdGFuY2UgPT09IFwiZmlyc3RcIikge1xuICAgICAgcmV0dXJuIG5hdHVyYWxJbnN0YW5jZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG5leHRJbnN0YW5jZTtcbiAgICB9XG4gIH0sXG5cbiAgcXVhcnRlcmx5RGF5c0Zyb21TdGFydDogZnVuY3Rpb24obnVtRGF5cywgaW5zdGFuY2UpIHtcbiAgICBjb25zdCBuZXh0UXVhcnRlciA9IG1vbWVudCgpLnF1YXJ0ZXIoKSArIDE7XG4gICAgY29uc3QgbmF0dXJhbEluc3RhbmNlID0gbW9tZW50KCkuc3RhcnRPZigncXVhcnRlcicpLmhvdXJzKDApLnNlY29uZHMoMCkubWlsbGlzZWNvbmQoMCkuYWRkKG51bURheXMsICdkYXlzJykuX2Q7XG4gICAgY29uc3QgbmV4dEluc3RhbmNlID0gbW9tZW50KCkucXVhcnRlcihuZXh0UXVhcnRlcikuZGF0ZSgxKS5ob3VycygwKS5zZWNvbmRzKDApLm1pbGxpc2Vjb25kKDApLmFkZChudW1EYXlzLCAnZGF5cycpLl9kO1xuXG4gICAgaWYgKG1vbWVudCgpLmlzQWZ0ZXIobmF0dXJhbEluc3RhbmNlKSA9PT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIG5leHRJbnN0YW5jZTtcbiAgICB9IGVsc2UgaWYgKGluc3RhbmNlID09PSBcImZpcnN0XCIpIHtcbiAgICAgIHJldHVybiBuYXR1cmFsSW5zdGFuY2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBuZXh0SW5zdGFuY2U7XG4gICAgfVxuICB9LFxuXG4gIHF1YXJ0ZXJseURheXNCZWZvcmVFbmQ6IGZ1bmN0aW9uKG51bURheXNCZWZvcmUsaW5zdGFuY2UpIHtcbiAgICBjb25zdCBuZXh0UXVhcnRlciA9IG1vbWVudCgpLnF1YXJ0ZXIoKSArIDE7XG4gICAgY29uc3QgbmF0dXJhbEluc3RhbmNlID0gIG1vbWVudCgpLmVuZE9mKFwicXVhcnRlclwiKS5zdWJ0cmFjdChudW1EYXlzQmVmb3JlLCBcImRheXNcIikuaG91cnMoZGVhZGxpbmVIb3VyKS5taW51dGUoMCkuc2Vjb25kKDApLm1pbGxpc2Vjb25kKDApLl9kO1xuICAgIGNvbnN0IG5leHRJbnN0YW5jZSA9IG1vbWVudCgpLnF1YXJ0ZXIobmV4dFF1YXJ0ZXIpLmVuZE9mKFwicXVhcnRlclwiKS5zdWJ0cmFjdChudW1EYXlzQmVmb3JlLCBcImRheXNcIikuaG91cnMoZGVhZGxpbmVIb3VyKS5taW51dGUoMCkuc2Vjb25kKDApLm1pbGxpc2Vjb25kKDApLl9kO1xuICAgIGlmIChtb21lbnQoKS5pc0FmdGVyKG5hdHVyYWxJbnN0YW5jZSkgPT09IHRydWUpIHtcbiAgICAgIHJldHVybiBuZXh0SW5zdGFuY2U7XG4gICAgfSBlbHNlIGlmIChpbnN0YW5jZSA9PT0gXCJmaXJzdFwiKSB7XG4gICAgICByZXR1cm4gbmF0dXJhbEluc3RhbmNlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbmV4dEluc3RhbmNlO1xuICAgIH1cbiAgfSxcblxuICBhbm51YWxseUZpcnN0RGF5OiBmdW5jdGlvbihpbnN0YW5jZSkge1xuICAgIGNvbnN0IG5leHRZZWFyID0gbW9tZW50KCkueWVhcigpICsgMTtcbiAgICByZXR1cm4gbW9tZW50KCkuaG91cnMoZGVhZGxpbmVIb3VyKS5taW51dGUoMCkuc2Vjb25kKDApLm1pbGxpc2Vjb25kKDApLnllYXIobmV4dFllYXIpLmRhdGUoMSkuX2Q7XG4gIH0sXG5cbiAgYW5udWFsbHlMYXN0RGF5OiBmdW5jdGlvbihpbnN0YW5jZSkge1xuICAgIGlmIChpbnN0YW5jZSA9PT0gXCJmaXJzdFwiKSB7XG4gICAgICByZXR1cm4gbW9tZW50KCkuZW5kT2YoXCJ5ZWFyXCIpLmhvdXJzKGRlYWRsaW5lSG91cikubWludXRlKDApLnNlY29uZCgwKS5taWxsaXNlY29uZCgwKS5fZDtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgbmV4dFllYXIgPSBtb21lbnQoKS55ZWFyKCkgKyAxO1xuICAgICAgcmV0dXJuIG1vbWVudCgpLnllYXIobmV4dFllYXIpLmVuZE9mKFwieWVhclwiKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuX2Q7XG4gICAgfVxuICB9LFxuXG4gIGFubnVhbGx5QW55RGF5OiBmdW5jdGlvbihpbnN0YW5jZSkge1xuICAgIGNvbnN0IG5leHRZZWFyID0gbW9tZW50KCkueWVhcigpICsgMTtcbiAgICBjb25zdCBuYXR1cmFsSW5zdGFuY2UgPSBtb21lbnQoKS5lbmRPZihcInllYXJcIikuaG91cnMoZGVhZGxpbmVIb3VyKS5taW51dGUoMCkuc2Vjb25kKDApLm1pbGxpc2Vjb25kKDApLl9kO1xuICAgIGNvbnN0IG5leHRJbnN0YW5jZSA9IG1vbWVudCgpLnllYXIobmV4dFllYXIpLmVuZE9mKFwieWVhclwiKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuX2Q7XG5cbiAgICBpZiAobW9tZW50KCkuaXNBZnRlcihuYXR1cmFsSW5zdGFuY2UpID09PSB0cnVlKSB7XG4gICAgICByZXR1cm4gbmV4dEluc3RhbmNlO1xuICAgIH0gZWxzZSBpZiAoaW5zdGFuY2UgPT09IFwiZmlyc3RcIikge1xuICAgICAgcmV0dXJuIG5hdHVyYWxJbnN0YW5jZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG5leHRJbnN0YW5jZTtcbiAgICB9XG4gIH0sXG5cbiAgYW5udWFsbHlEYXlzRnJvbVN0YXJ0OiBmdW5jdGlvbihudW1EYXlzLCBpbnN0YW5jZSkge1xuICAgIGNvbnN0IG5leHRZZWFyID0gbW9tZW50KCkueWVhcigpICsgMTtcbiAgICBjb25zdCBuYXR1cmFsSW5zdGFuY2UgPSBtb21lbnQoKS5zdGFydE9mKCd5ZWFyJykuaG91cnMoMCkuc2Vjb25kcygwKS5taWxsaXNlY29uZCgwKS5hZGQobnVtRGF5cywgJ2RheXMnKS5fZDtcbiAgICBjb25zdCBuZXh0SW5zdGFuY2UgPSBtb21lbnQoKS55ZWFyKG5leHRZZWFyKS5zdGFydE9mKCd5ZWFyJykuaG91cnMoMCkuc2Vjb25kcygwKS5taWxsaXNlY29uZCgwKS5hZGQobnVtRGF5cywgJ2RheXMnKS5fZDtcblxuICAgIGlmIChtb21lbnQoKS5pc0FmdGVyKG5hdHVyYWxJbnN0YW5jZSkgPT09IHRydWUpIHtcbiAgICAgIHJldHVybiBuZXh0SW5zdGFuY2U7XG4gICAgfSBlbHNlIGlmIChpbnN0YW5jZSA9PT0gXCJmaXJzdFwiKSB7XG4gICAgICByZXR1cm4gbmF0dXJhbEluc3RhbmNlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbmV4dEluc3RhbmNlO1xuICAgIH1cbiAgfSxcblxuXG4gIGFubnVhbGx5RGF5c0JlZm9yZUVuZDogZnVuY3Rpb24obnVtRGF5c0JlZm9yZSwgaW5zdGFuY2UpIHtcbiAgICBjb25zdCBuZXh0WWVhciA9IG1vbWVudCgpLnllYXIoKSArIDE7XG4gICAgY29uc3QgbmF0dXJhbEluc3RhbmNlID0gbW9tZW50KCkuZW5kT2YoXCJ5ZWFyXCIpLnN1YnRyYWN0KG51bURheXNCZWZvcmUsIFwiZGF5c1wiKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuX2Q7XG4gICAgY29uc3QgbmV4dEluc3RhbmNlID0gbW9tZW50KCkueWVhcihuZXh0WWVhcikuZW5kT2YoXCJ5ZWFyXCIpLnN1YnRyYWN0KG51bURheXNCZWZvcmUsIFwiZGF5c1wiKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuX2Q7XG5cbiAgICBpZiAobW9tZW50KCkuaXNBZnRlcihuYXR1cmFsSW5zdGFuY2UpID09PSB0cnVlKSB7XG4gICAgICByZXR1cm4gbmV4dEluc3RhbmNlO1xuICAgIH0gZWxzZSBpZiAoaW5zdGFuY2UgPT09IFwiZmlyc3RcIikge1xuICAgICAgcmV0dXJuIG5hdHVyYWxJbnN0YW5jZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG5leHRJbnN0YW5jZTtcbiAgICB9XG4gIH0sXG5cblxuICBhbm51YWxseVBhcnRpY3VsYXJNb250aDogZnVuY3Rpb24oc2VsZWN0ZWRNb250aCwgaW5zdGFuY2UpIHtcbiAgICBjb25zb2xlLmxvZyhcIiMxMiAtIE1hZGUgaXQgdG8gYW5udWFsbHlQYXJ0aWN1bGFyTW9udGhcIik7XG4gICAgY29uc29sZS5sb2coXCJNT05USFwiLCBzZWxlY3RlZE1vbnRoKTtcbiAgICBjb25zdCBuZXh0WWVhciA9IG1vbWVudCgpLnllYXIoKSArIDE7XG4gICAgY29uc3QgbmF0dXJhbEluc3RhbmNlID0gbW9tZW50KCkubW9udGgoc2VsZWN0ZWRNb250aCkuZW5kT2YoXCJtb250aFwiKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuX2Q7XG4gICAgY29uc3QgbmV4dEluc3RhbmNlID0gbW9tZW50KCkueWVhcihuZXh0WWVhcikubW9udGgoc2VsZWN0ZWRNb250aCkuZW5kT2YoXCJtb250aFwiKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuX2Q7XG4gICAgICBcblxuICAgIGlmIChtb21lbnQoKS5pc0FmdGVyKG5hdHVyYWxJbnN0YW5jZSkgPT09IHRydWUpIHtcbiAgICAgICAgY29uc29sZS5sb2coJyEhISEhIScpO1xuICAgICAgcmV0dXJuIG5leHRJbnN0YW5jZTtcbiAgICB9IGVsc2UgaWYgKGluc3RhbmNlID09PSBcImZpcnN0XCIpIHtcbiAgICAgIHJldHVybiBuYXR1cmFsSW5zdGFuY2U7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coJz8/Pz8/PycpO1xuICAgICAgcmV0dXJuIG5leHRJbnN0YW5jZTtcbiAgICB9XG4gIH0sXG5cbiAgYW5udWFsbHlQYXJ0aWN1bGFyUXVhcnRlcjogZnVuY3Rpb24oc2VsZWN0ZWRRdWFydGVyLCBpbnN0YW5jZSkge1xuICAgIGNvbnN0IG5leHRZZWFyID0gbW9tZW50KCkueWVhcigpICsgMTtcbiAgICBjb25zdCBuYXR1cmFsSW5zdGFuY2UgPSBtb21lbnQoKS5xdWFydGVyKHNlbGVjdGVkUXVhcnRlcikuZW5kT2YoXCJxdWFydGVyXCIpLmhvdXJzKGRlYWRsaW5lSG91cikubWludXRlKDApLnNlY29uZCgwKS5taWxsaXNlY29uZCgwKS5fZDtcbiAgICBjb25zdCBuZXh0SW5zdGFuY2UgPSBtb21lbnQoKS55ZWFyKG5leHRZZWFyKS5xdWFydGVyKHNlbGVjdGVkUXVhcnRlcikuZW5kT2YoXCJxdWFydGVyXCIpLmhvdXJzKGRlYWRsaW5lSG91cikubWludXRlKDApLnNlY29uZCgwKS5taWxsaXNlY29uZCgwKS5fZDtcblxuICAgIGlmIChtb21lbnQoKS5pc0FmdGVyKG5hdHVyYWxJbnN0YW5jZSkgPT09IHRydWUpIHtcbiAgICAgIHJldHVybiBuZXh0SW5zdGFuY2U7XG4gICAgfSBlbHNlIGlmIChpbnN0YW5jZSA9PT0gXCJmaXJzdFwiKSB7XG4gICAgICByZXR1cm4gbmF0dXJhbEluc3RhbmNlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbmV4dEluc3RhbmNlO1xuICAgIH1cbiAgfSxcblxuICBzZW1pTW9udGhseUZpcnN0Q3ljbGU6IGZ1bmN0aW9uKHNlbGVjdGVkRGF0ZSkge1xuICAgIHJldHVybiBtb21lbnQoKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuZGF0ZShzZWxlY3RlZERhdGUpLl9kO1xuICB9LFxuXG4gIHNlbWlNb3RobHlTZWNvbmRDeWNsZTogZnVuY3Rpb24oZmlyc3RDeWNsZURhdGUpIHtcbiAgICByZXR1cm4gbW9tZW50KCkuaG91cnMoZGVhZGxpbmVIb3VyKS5taW51dGUoMCkuc2Vjb25kKDApLm1pbGxpc2Vjb25kKDApLmRhdGUoZmlyc3RDeWNsZURhdGUgKyAxNSkuX2Q7XG4gIH0sXG5cbm5leHRCdXNpbmVzc0RheTogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGlzSW4gPSBmdW5jdGlvbiAoaW5jcmVhc2VEYXlzKSB7XG4gICAgICAgIC8vU2V0cyBhIG51bWJlciBmb3IgZGF5IG9mIHRoZSB3ZWVrLi4uU3VuZGF5ID0gMCwgTW9uZGF5ID0gMSBldGMuXG4gICAgICAgIGNvbnN0IHRvZGF5ID0gbW9tZW50KCkuZGF5KCk7XG4gICAgICAgIGNvbnN0IG5leHRCRCA9IHRvZGF5ICsgaW5jcmVhc2VEYXlzO1xuICAgICAgICBsZXQgZmxhZyA9IGZhbHNlO1xuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IDYgOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChpID09PSBuZXh0QkQpIHtcbiAgICAgICAgICAgICAgICBmbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmxhZztcbiAgICB9O1xuICAgIGlmIChpc0luKDEpID09PSB0cnVlKSB7XG4gICAgICAgIHJldHVybiBtb21lbnQoKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuYWRkKDEsICdkYXlzJykuX2Q7XG4gICAgfVxuICAgIHJldHVybiBtb21lbnQoKS5ob3VycyhkZWFkbGluZUhvdXIpLm1pbnV0ZSgwKS5zZWNvbmQoMCkubWlsbGlzZWNvbmQoMCkuYWRkKDEsIFwid2Vla3NcIikuc3RhcnRPZignaXNvV2VlaycpLl9kO1xufSxcblxuXG59O1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
