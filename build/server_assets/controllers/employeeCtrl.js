'use strict';

var mongoose = require('mongoose');
var Employee = require('../models/Employee.js');
var Company = require('../models/Company');
var Department = require('../models/Department.js');
var Position = require('../models/Position.js');

module.exports = {
  newEmployee: function newEmployee(req, res) {
    console.log("POST - ADD EMPLOYEE ENDPOINT", req.body);
    var newEmployee = new Employee(req.body);
    Company.findOne({
      _id: req.params.companyid
    }).exec().then(function (result) {
      console.log(result);
      result.employees.push(newEmployee._id);
      result.save();
    });
    Department.findOne({
      _id: req.params.departmentid
    }).exec().then(function (result) {
      console.log(result);
      result.employees.push(newEmployee._id);
      result.save();
    });
    Position.findOne({
      _id: req.params.positionid
    }).exec().then(function (result) {
      console.log(result);
      result.employees.push(newEmployee._id);
      result.save();
    });
    newEmployee.company = req.params.companyid;
    newEmployee.departments = req.params.departmentid;
    newEmployee.positions = req.params.positionid;
    newEmployee.identification.name.fullName = req.body.identification.name.firstName + " " + req.body.identification.name.lastName;
    newEmployee.save().then(function (result) {
      return res.json(result);
    }).catch(function (err) {
      return res.status(500).end();
    });
  },
  oneEmployee: function oneEmployee(req, res) {
    console.log("GET - EMPLOYEE ID: ", req.params.id);
    Employee.findById(req.params.id).exec().then(function (employee) {
      return res.json(employee);
    }).catch(function (err) {
      return res.status(500).end();
    });
  },
  editEmployee: function editEmployee(req, res) {
    console.log("EDIT - EMPLOYEE ID: ", req.params.id);
    Employee.update({
      _id: req.params.id
    }, req.body).then(function () {
      return res.status(200).end();
    }).catch(function (err) {
      return res.status(500).end();
    });
  },
  deleteEmployee: function deleteEmployee(req, res) {
    console.log("DELETE - EMPLOYEE ID: ", req.params.id);
    Employee.remove({
      _id: req.params.id
    }, req.body).then(function () {
      return res.status(200).end();
    }).catch(function (err) {
      return res.status(500).end();
    });
  },

  // allEmployees(req, res) {
  //   console.log('GET - ALL EMPLOYEES ENDPOINT');
  //   Company
  //     .findOne({
  //       _id: req.params.companyid
  //     })
  //     .populate('employees')
  //     .exec(function(err, company) {
  //       console.log('COMPANY FOUND:', company);
  //       Employee.populate 
  //     }
  //   }

  allEmployees: function allEmployees(req, res) {
    console.log('GET - ALL EMPLOYEES ENDPOINT');

    var options = {
      path: 'employees',
      model: 'Employee',
      populate: [{
        path: 'departments',
        model: 'Department',
        select: 'name'
      }, {
        path: 'positions',
        model: 'Position',
        select: 'name'
      }]
    };
    console.log('options for populate', options);
    console.log();
    Company.findOne({
      _id: req.params.companyid
    }).select('employees').populate(options).exec().then(function (company) {
      res.status(200).json(company.employees);
    }).catch(function (e) {
      console.log("MONGOOSE ERROR >>>", e.message);
      res.status(500).json(e);
    });
  }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlcl9hc3NldHMvY29udHJvbGxlcnMvZW1wbG95ZWVDdHJsLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBTSxRQUFRLEdBQUcsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQ3JDLElBQU0sUUFBUSxHQUFHLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO0FBQ2xELElBQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO0FBQzdDLElBQU0sVUFBVSxHQUFHLE9BQU8sQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDO0FBQ3RELElBQU0sUUFBUSxHQUFHLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDOztBQUVsRCxNQUFNLENBQUMsT0FBTyxHQUFHO0FBRWYsYUFBVyx1QkFBQyxHQUFHLEVBQUUsR0FBRyxFQUFFO0FBQ3BCLFdBQU8sQ0FBQyxHQUFHLENBQUMsOEJBQThCLEVBQUUsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3RELFFBQU0sV0FBVyxHQUFHLElBQUksUUFBUSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUMzQyxXQUFPLENBQ0EsT0FBTyxDQUFDO0FBQ1AsU0FBRyxFQUFFLEdBQUcsQ0FBQyxNQUFNLENBQUMsU0FBUztLQUMxQixDQUFDLENBQ0QsSUFBSSxFQUFFLENBQ04sSUFBSSxDQUFDLFVBQVMsTUFBTSxFQUFFO0FBQ3JCLGFBQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDcEIsWUFBTSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3ZDLFlBQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQztLQUNmLENBQUMsQ0FBQztBQUNULGNBQVUsQ0FDSCxPQUFPLENBQUM7QUFDUCxTQUFHLEVBQUUsR0FBRyxDQUFDLE1BQU0sQ0FBQyxZQUFZO0tBQzdCLENBQUMsQ0FDRCxJQUFJLEVBQUUsQ0FDTixJQUFJLENBQUMsVUFBUyxN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Q0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsVUFBUyxPQUFPLEVBQUM7QUFDOUMsU0FBRyxDQUNBLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FDWCxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFBO0tBQzNCLENBQUMsQ0FBQyxLQUFLLENBQUMsVUFBUyxDQUFDLEVBQUM7QUFDbEIsYUFBTyxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUE7QUFDNUMsU0FBRyxDQUNBLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FDWCxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUE7S0FFWCxDQUFDLENBQUE7R0FDTDtDQUNGLENBQUMiLCJmaWxlIjoic2VydmVyX2Fzc2V0cy9jb250cm9sbGVycy9lbXBsb3llZUN0cmwuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7XG5jb25zdCBFbXBsb3llZSA9IHJlcXVpcmUoJy4uL21vZGVscy9FbXBsb3llZS5qcycpO1xuY29uc3QgQ29tcGFueSA9IHJlcXVpcmUoJy4uL21vZGVscy9Db21wYW55Jyk7XG5jb25zdCBEZXBhcnRtZW50ID0gcmVxdWlyZSgnLi4vbW9kZWxzL0RlcGFydG1lbnQuanMnKTtcbmNvbnN0IFBvc2l0aW9uID0gcmVxdWlyZSgnLi4vbW9kZWxzL1Bvc2l0aW9uLmpzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuXG4gIG5ld0VtcGxveWVlKHJlcSwgcmVzKSB7XG4gICAgY29uc29sZS5sb2coXCJQT1NUIC0gQUREIEVNUExPWUVFIEVORFBPSU5UXCIsIHJlcS5ib2R5KTtcbiAgICBjb25zdCBuZXdFbXBsb3llZSA9IG5ldyBFbXBsb3llZShyZXEuYm9keSk7XG4gICAgQ29tcGFueVxuICAgICAgICAgIC5maW5kT25lKHtcbiAgICAgICAgICAgIF9pZDogcmVxLnBhcmFtcy5jb21wYW55aWRcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5leGVjKClcbiAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XG4gICAgICAgICAgICByZXN1bHQuZW1wbG95ZWVzLnB1c2gobmV3RW1wbG95ZWUuX2lkKTtcbiAgICAgICAgICAgIHJlc3VsdC5zYXZlKCk7XG4gICAgICAgICAgfSk7XG4gICAgRGVwYXJ0bWVudFxuICAgICAgICAgIC5maW5kT25lKHtcbiAgICAgICAgICAgIF9pZDogcmVxLnBhcmFtcy5kZXBhcnRtZW50aWRcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5leGVjKClcbiAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XG4gICAgICAgICAgICByZXN1bHQuZW1wbG95ZWVzLnB1c2gobmV3RW1wbG95ZWUuX2lkKTtcbiAgICAgICAgICAgIHJlc3VsdC5zYXZlKCk7XG4gICAgICAgICAgfSk7XG4gICAgUG9zaXRpb25cbiAgICAgICAgICAuZmluZE9uZSh7XG4gICAgICAgICAgICBfaWQ6IHJlcS5wYXJhbXMucG9zaXRpb25pZFxuICAgICAgICAgIH0pXG4gICAgICAgICAgLmV4ZWMoKVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgICAgICAgIHJlc3VsdC5lbXBsb3llZXMucHVzaChuZXdFbXBsb3llZS5faWQpO1xuICAgICAgICAgICAgcmVzdWx0LnNhdmUoKTtcbiAgICAgICAgICB9KTtcbiAgICBuZXdFbXBsb3llZS5jb21wYW55ID0gcmVxLnBhcmFtcy5jb21wYW55aWQ7XG4gICAgbmV3RW1wbG95ZWUuZGVwYXJ0bWVudHMgPSByZXEucGFyYW1zLmRlcGFydG1lbnRpZDtcbiAgICBuZXdFbXBsb3llZS5wb3NpdGlvbnMgPSByZXEucGFyYW1zLnBvc2l0aW9uaWQ7XG4gICAgbmV3RW1wbG95ZWUuaWRlbnRpZmljYXRpb24ubmFtZS5mdWxsTmFtZSA9IHJlcS5ib2R5LmlkZW50aWZpY2F0aW9uLm5hbWUuZmlyc3ROYW1lICsgXCIgXCIgKyByZXEuYm9keS5pZGVudGlmaWNhdGlvbi5uYW1lLmxhc3ROYW1lO1xuICAgIG5ld0VtcGxveWVlLnNhdmUoKS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgIHJldHVybiByZXMuanNvbihyZXN1bHQpO1xuICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuZW5kKCk7XG4gICAgfSk7XG4gIH0sXG5cbiAgb25lRW1wbG95ZWUocmVxLCByZXMpIHtcbiAgICBjb25zb2xlLmxvZyhcIkdFVCAtIEVNUExPWUVFIElEOiBcIiwgcmVxLnBhcmFtcy5pZCk7XG4gICAgRW1wbG95ZWUuZmluZEJ5SWQocmVxLnBhcmFtcy5pZCkuZXhlYygpLnRoZW4oKGVtcGxveWVlKSA9PiB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oZW1wbG95ZWUpO1xuICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuZW5kKCk7XG4gICAgfSk7XG4gIH0sXG5cbiAgZWRpdEVtcGxveWVlKHJlcSwgcmVzKSB7XG4gICAgY29uc29sZS5sb2coXCJFRElUIC0gRU1QTE9ZRUUgSUQ6IFwiLCByZXEucGFyYW1zLmlkKTtcbiAgICBFbXBsb3llZS51cGRhdGUoe1xuICAgICAgX2lkOiByZXEucGFyYW1zLmlkXG4gICAgfSwgcmVxLmJvZHkpLnRoZW4oKCkgPT4ge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5lbmQoKTtcbiAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmVuZCgpO1xuICAgIH0pO1xuICB9LFxuXG4gIGRlbGV0ZUVtcGxveWVlKHJlcSwgcmVzKSB7XG4gICAgY29uc29sZS5sb2coXCJERUxFVEUgLSBFTVBMT1lFRSBJRDogXCIsIHJlcS5wYXJhbXMuaWQpO1xuICAgIEVtcGxveWVlLnJlbW92ZSh7XG4gICAgICBfaWQ6IHJlcS5wYXJhbXMuaWRcbiAgICB9LCByZXEuYm9keSkudGhlbigoKSA9PiB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmVuZCgpO1xuICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuZW5kKCk7XG4gICAgfSk7XG4gIH0sXG5cbiAgLy8gYWxsRW1wbG95ZWVzKHJlcSwgcmVzKSB7XG4gIC8vICAgY29uc29sZS5sb2coJ0dFVCAtIEFMTCBFTVBMT1lFRVMgRU5EUE9JTlQnKTtcbiAgLy8gICBDb21wYW55XG4gIC8vICAgICAuZmluZE9uZSh7XG4gIC8vICAgICAgIF9pZDogcmVxLnBhcmFtcy5jb21wYW55aWRcbiAgLy8gICAgIH0pXG4gIC8vICAgICAucG9wdWxhdGUoJ2VtcGxveWVlcycpXG4gIC8vICAgICAuZXhlYyhmdW5jdGlvbihlcnIsIGNvbXBhbnkpIHtcbiAgLy8gICAgICAgY29uc29sZS5sb2coJ0NPTVBBTlkgRk9VTkQ6JywgY29tcGFueSk7XG4gIC8vICAgICAgIEVtcGxveWVlLnBvcHVsYXRlICBcbiAgLy8gICAgIH1cbiAgLy8gICB9XG5cbiAgYWxsRW1wbG95ZWVzKHJlcSwgcmVzKSB7XG4gICAgY29uc29sZS5sb2coJ0dFVCAtIEFMTCBFTVBMT1lFRVMgRU5EUE9JTlQnKTtcbiAgICBcbiAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgIHBhdGg6ICdlbXBsb3llZXMnLFxuICAgICAgbW9kZWw6ICdFbXBsb3llZScsXG4gICAgICBwb3B1bGF0ZTogW3tcbiAgICAgICAgcGF0aDogJ2RlcGFydG1lbnRzJyxcbiAgICAgICAgbW9kZWw6ICdEZXBhcnRtZW50JyxcbiAgICAgICAgc2VsZWN0OiAnbmFtZSdcbiAgICAgIH0se1xuICAgICAgICBwYXRoOiAncG9zaXRpb25zJyxcbiAgICAgICAgbW9kZWw6ICdQb3NpdGlvbicsXG4gICAgICAgIHNlbGVjdDogJ25hbWUnXG4gICAgICB9XVxuICAgIH1cbiAgICBjb25zb2xlLmxvZygnb3B0aW9ucyBmb3IgcG9wdWxhdGUnLCBvcHRpb25zKVxuICAgIGNvbnNvbGUubG9nKClcbiAgICBDb21wYW55XG4gICAgICAuZmluZE9uZSh7XG4gICAgICAgIF9pZDogcmVxLnBhcmFtcy5jb21wYW55aWRcbiAgICAgIH0pXG4gICAgICAuc2VsZWN0KCdlbXBsb3llZXMnKVxuICAgICAgLnBvcHVsYXRlKG9wdGlvbnMpLmV4ZWMoKS50aGVuKGZ1bmN0aW9uKGNvbXBhbnkpe1xuICAgICAgICByZXNcbiAgICAgICAgICAuc3RhdHVzKDIwMClcbiAgICAgICAgICAuanNvbihjb21wYW55LmVtcGxveWVlcylcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGUpe1xuICAgICAgICBjb25zb2xlLmxvZyhcIk1PTkdPT1NFIEVSUk9SID4+PlwiLCBlLm1lc3NhZ2UpXG4gICAgICAgIHJlc1xuICAgICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAgIC5qc29uKGUpXG5cbiAgICAgIH0pXG4gIH1cbn07XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
